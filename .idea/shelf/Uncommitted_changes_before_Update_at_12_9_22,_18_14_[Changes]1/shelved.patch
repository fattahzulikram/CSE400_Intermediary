Index: settings.gradle
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>pluginManagement {\n    repositories {\n        gradlePluginPortal()\n        google()\n        mavenCentral()\n    }\n}\ndependencyResolutionManagement {\n    repositoriesMode.set(RepositoriesMode.FAIL_ON_PROJECT_REPOS)\n    repositories {\n        google()\n        mavenCentral()\n        maven { url 'https://jitpack.io' }\n        maven { url \"https://maven.aliyun.com/repository/jcenter\" }\n    }\n}\nrootProject.name = \"Doctor\"\ninclude ':app'\n
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/settings.gradle b/settings.gradle
--- a/settings.gradle	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/settings.gradle	(date 1670572889701)
@@ -10,9 +10,12 @@
     repositories {
         google()
         mavenCentral()
+        jcenter()
         maven { url 'https://jitpack.io' }
-        maven { url "https://maven.aliyun.com/repository/jcenter" }
+        maven {
+            url "https://github.com/jitsi/jitsi-maven-repository/raw/master/releases"
+        }
     }
 }
-rootProject.name = "Doctor"
+rootProject.name = "Shasthosheba_patient"
 include ':app'
Index: app/src/main/AndroidManifest.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<manifest xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    package=\"com.example.doctor\">\n\n    <uses-permission android:name=\"android.permission.RECORD_AUDIO\" />\n    <uses-permission android:name=\"android.permission.INTERNET\" />\n    <uses-permission android:name=\"android.permission.READ_PHONE_STATE\" />\n    <uses-permission android:name=\"android.permission.CAMERA\" />\n\n    <!-- Needed to communicate with already-paired Bluetooth devices. (Legacy up to Android 11) -->\n    <uses-permission\n        android:name=\"android.permission.BLUETOOTH\"\n        android:maxSdkVersion=\"30\" />\n    <uses-permission\n        android:name=\"android.permission.BLUETOOTH_ADMIN\"\n        android:maxSdkVersion=\"30\" />\n\n    <!-- Needed to communicate with already-paired Bluetooth devices. (Android 12 upwards)-->\n    <uses-permission android:name=\"android.permission.BLUETOOTH_CONNECT\" />\n\n\n    <application\n        android:name=\".app.App\"\n        android:allowBackup=\"true\"\n        android:dataExtractionRules=\"@xml/data_extraction_rules\"\n        android:fullBackupContent=\"@xml/backup_rules\"\n        android:icon=\"@mipmap/ic_launcher\"\n        android:label=\"@string/app_name\"\n        android:roundIcon=\"@mipmap/ic_launcher_round\"\n        android:supportsRtl=\"true\"\n        android:theme=\"@style/Theme.Doctor\"\n        tools:targetApi=\"31\">\n        <activity\n            android:name=\".videocall.VideoCallActivity\"\n            android:exported=\"false\" />\n        <activity\n            android:name=\".StartActivity\"\n            android:exported=\"true\">\n            <intent-filter>\n                <action android:name=\"android.intent.action.MAIN\" />\n\n                <category android:name=\"android.intent.category.LAUNCHER\" />\n            </intent-filter>\n        </activity>\n    </application>\n\n</manifest>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/AndroidManifest.xml b/app/src/main/AndroidManifest.xml
--- a/app/src/main/AndroidManifest.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/src/main/AndroidManifest.xml	(date 1670580594978)
@@ -1,25 +1,21 @@
 <?xml version="1.0" encoding="utf-8"?>
 <manifest xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:tools="http://schemas.android.com/tools"
-    package="com.example.doctor">
+    package="com.shasthosheba.patient" >
 
+    <uses-permission android:name="android.permission.POST_NOTIFICATIONS" />
     <uses-permission android:name="android.permission.RECORD_AUDIO" />
     <uses-permission android:name="android.permission.INTERNET" />
     <uses-permission android:name="android.permission.READ_PHONE_STATE" />
-    <uses-permission android:name="android.permission.CAMERA" />
-
-    <!-- Needed to communicate with already-paired Bluetooth devices. (Legacy up to Android 11) -->
+    <uses-permission android:name="android.permission.CAMERA" /> <!-- Needed to communicate with already-paired Bluetooth devices. (Legacy up to Android 11) -->
     <uses-permission
         android:name="android.permission.BLUETOOTH"
         android:maxSdkVersion="30" />
     <uses-permission
         android:name="android.permission.BLUETOOTH_ADMIN"
-        android:maxSdkVersion="30" />
-
-    <!-- Needed to communicate with already-paired Bluetooth devices. (Android 12 upwards)-->
+        android:maxSdkVersion="30" /> <!-- Needed to communicate with already-paired Bluetooth devices. (Android 12 upwards) -->
     <uses-permission android:name="android.permission.BLUETOOTH_CONNECT" />
 
-
     <application
         android:name=".app.App"
         android:allowBackup="true"
@@ -29,20 +25,43 @@
         android:label="@string/app_name"
         android:roundIcon="@mipmap/ic_launcher_round"
         android:supportsRtl="true"
-        android:theme="@style/Theme.Doctor"
-        tools:targetApi="31">
+        android:theme="@style/Theme.Patient"
+        tools:targetApi="31" >
         <activity
-            android:name=".videocall.VideoCallActivity"
+            android:name=".patient.PrescriptionViewActivity"
+            android:exported="false" />
+        <activity
+            android:name=".patient.PatientDetailsActivity"
             android:exported="false" />
         <activity
+            android:name=".patient.AddPatientActivity"
+            android:exported="false"
+            android:parentActivityName=".MainActivity"
+            android:theme="@style/Theme.Patient" />
+        <activity
+            android:name=".MainActivity"
+            android:exported="false"
+            android:label="@string/patients"
+            android:theme="@style/Theme.Patient.NoActionBar" />
+        <activity
             android:name=".StartActivity"
-            android:exported="true">
+            android:exported="true"
+            android:theme="@style/Theme.Patient.NoActionBar" >
             <intent-filter>
                 <action android:name="android.intent.action.MAIN" />
 
                 <category android:name="android.intent.category.LAUNCHER" />
             </intent-filter>
         </activity>
+
+        <receiver
+            android:name=".BroadcastReceiver"
+            android:exported="false" >
+            <intent-filter>
+                <action android:name="Jitsi_call_accept" />
+                <action android:name="Jitsi_call_reject" />
+            </intent-filter>
+        </receiver>
     </application>
 
 </manifest>
\ No newline at end of file
Index: app/src/main/res/values/strings.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources>\n    <string name=\"app_name\">Doctor</string>\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/strings.xml b/app/src/main/res/values/strings.xml
--- a/app/src/main/res/values/strings.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/src/main/res/values/strings.xml	(date 1670581487621)
@@ -1,3 +1,17 @@
 <resources>
-    <string name="app_name">Doctor</string>
+    <string name="app_name">Patient</string>
+    <string name="sign_out">Sign out</string>
+    <string name="add_new_patient">Add new patient</string>
+    <string name="patients">Patients</string>
+    <string name="add">Add</string>
+    <string name="patient_birth_year">Patient birth year</string>
+    <string name="patient_name">Patient name</string>
+    <string name="connecting">Connectingâ€¦</string>
+    <string name="connection_lost">Connection lost</string>
+    <string name="doctor">Doctor:</string>
+    <string name="patient">Patient:</string>
+    <string name="illness">Illness:</string>
+    <string name="medicines">Medicines:</string>
+    <string name="tests">Tests:</string>
+    <string name="advice">Advice:</string>
 </resources>
\ No newline at end of file
Index: app/build.gradle
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>plugins {\n    id 'com.android.application'\n    id 'com.google.gms.google-services'\n}\n\nandroid {\n    compileSdk 32\n\n    defaultConfig {\n        applicationId \"com.example.doctor\"\n        minSdk 21\n        targetSdk 32\n        versionCode 1\n        versionName \"1.0\"\n\n        testInstrumentationRunner \"androidx.test.runner.AndroidJUnitRunner\"\n    }\n\n    buildTypes {\n        release {\n            minifyEnabled false\n            proguardFiles getDefaultProguardFile('proguard-android-optimize.txt'), 'proguard-rules.pro'\n        }\n    }\n\n    buildFeatures {\n        viewBinding true\n    }\n\n    compileOptions {\n        sourceCompatibility JavaVersion.VERSION_1_8\n        targetCompatibility JavaVersion.VERSION_1_8\n    }\n}\n\ndependencies {\n    implementation 'live.videosdk:rtc-android-sdk:0.1.8'\n\n    implementation 'androidx.appcompat:appcompat:1.5.1'\n    implementation 'com.google.android.material:material:1.7.0'\n    implementation 'androidx.constraintlayout:constraintlayout:2.1.4'\n    testImplementation 'junit:junit:4.13.2'\n    androidTestImplementation 'androidx.test.ext:junit:1.1.4'\n    androidTestImplementation 'androidx.test.espresso:espresso-core:3.5.0'\n\n    //firebase\n    implementation platform('com.google.firebase:firebase-bom:31.1.0')\n    implementation 'com.google.firebase:firebase-analytics'\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/build.gradle b/app/build.gradle
--- a/app/build.gradle	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/build.gradle	(date 1670572889705)
@@ -7,8 +7,8 @@
     compileSdk 32
 
     defaultConfig {
-        applicationId "com.example.doctor"
-        minSdk 21
+        applicationId "com.shasthosheba.patient"
+        minSdk 23
         targetSdk 32
         versionCode 1
         versionName "1.0"
@@ -34,8 +34,12 @@
 }
 
 dependencies {
-    implementation 'live.videosdk:rtc-android-sdk:0.1.8'
+    implementation ('org.jitsi.react:jitsi-meet-sdk:7.0.0') { transitive = true }
+    implementation 'com.google.code.gson:gson:2.10'
+    implementation 'com.github.d-max:spots-dialog:1.1@aar'
 
+
+    implementation 'com.jakewharton.timber:timber:4.7.1'
     implementation 'androidx.appcompat:appcompat:1.5.1'
     implementation 'com.google.android.material:material:1.7.0'
     implementation 'androidx.constraintlayout:constraintlayout:2.1.4'
@@ -46,4 +50,10 @@
     //firebase
     implementation platform('com.google.firebase:firebase-bom:31.1.0')
     implementation 'com.google.firebase:firebase-analytics'
+    implementation 'com.firebaseui:firebase-ui-auth:7.2.0'
+    implementation 'com.google.android.gms:play-services-auth:20.4.0'
+    implementation 'com.google.firebase:firebase-database'
+    implementation 'com.google.firebase:firebase-firestore'
+
+
 }
\ No newline at end of file
Index: app/src/main/java/com/example/doctor/app/App.java
===================================================================
diff --git a/app/src/main/java/com/example/doctor/app/App.java b/app/src/main/java/com/example/doctor/app/App.java
deleted file mode 100644
--- a/app/src/main/java/com/example/doctor/app/App.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,13 +0,0 @@
-package com.example.doctor.app;
-
-import android.app.Application;
-
-import live.videosdk.rtc.android.VideoSDK;
-
-public class App extends Application {
-    @Override
-    public void onCreate() {
-        super.onCreate();
-        VideoSDK.initialize(getApplicationContext());
-    }
-}
Index: .idea/.gitignore
===================================================================
diff --git a/.idea/.gitignore b/.idea/.gitignore
deleted file mode 100644
--- a/.idea/.gitignore	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,3 +0,0 @@
-# Default ignored files
-/shelf/
-/workspace.xml
Index: app/src/main/java/com/example/doctor/videocall/VideoCallActivity.java
===================================================================
diff --git a/app/src/main/java/com/example/doctor/videocall/VideoCallActivity.java b/app/src/main/java/com/example/doctor/videocall/VideoCallActivity.java
deleted file mode 100644
--- a/app/src/main/java/com/example/doctor/videocall/VideoCallActivity.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,23 +0,0 @@
-package com.example.doctor.videocall;
-
-import androidx.appcompat.app.AppCompatActivity;
-
-import android.os.Bundle;
-
-import com.example.doctor.R;
-import com.example.doctor.databinding.ActivityStartBinding;
-import com.example.doctor.databinding.ActivityVideoCallBinding;
-
-public class VideoCallActivity extends AppCompatActivity {
-
-    private ActivityVideoCallBinding binding;
-
-    @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        super.onCreate(savedInstanceState);
-        binding = ActivityVideoCallBinding.inflate(getLayoutInflater());
-        setContentView(binding.getRoot());
-
-
-    }
-}
\ No newline at end of file
Index: app/src/main/res/layout/activity_video_call.xml
===================================================================
diff --git a/app/src/main/res/layout/activity_video_call.xml b/app/src/main/res/layout/activity_video_call.xml
deleted file mode 100644
--- a/app/src/main/res/layout/activity_video_call.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,9 +0,0 @@
-<?xml version="1.0" encoding="utf-8"?>
-<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
-    xmlns:app="http://schemas.android.com/apk/res-auto"
-    xmlns:tools="http://schemas.android.com/tools"
-    android:layout_width="match_parent"
-    android:layout_height="match_parent"
-    tools:context=".videocall.VideoCallActivity">
-
-</androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
Index: app/src/main/java/com/example/doctor/VideoCallActivity.java
===================================================================
diff --git a/app/src/main/java/com/example/doctor/VideoCallActivity.java b/app/src/main/java/com/example/doctor/VideoCallActivity.java
deleted file mode 100644
--- a/app/src/main/java/com/example/doctor/VideoCallActivity.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,6 +0,0 @@
-package com.example.doctor;
-
-import android.app.Activity;
-
-public class VideoCallActivity extends Activity {
-}
Index: app/src/main/java/com/example/doctor/StartActivity.java
===================================================================
diff --git a/app/src/main/java/com/example/doctor/StartActivity.java b/app/src/main/java/com/example/doctor/StartActivity.java
deleted file mode 100644
--- a/app/src/main/java/com/example/doctor/StartActivity.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,18 +0,0 @@
-package com.example.doctor;
-
-import androidx.appcompat.app.AppCompatActivity;
-
-import android.os.Bundle;
-
-import com.example.doctor.databinding.ActivityStartBinding;
-
-public class StartActivity extends AppCompatActivity {
-
-    private ActivityStartBinding binding;
-    @Override
-    protected void onCreate(Bundle savedInstanceState) {
-        super.onCreate(savedInstanceState);
-        binding = ActivityStartBinding.inflate(getLayoutInflater());
-        setContentView(binding.getRoot());
-    }
-}
\ No newline at end of file
Index: app/src/main/java/com/example/doctor/app/PublicVariables.java
===================================================================
diff --git a/app/src/main/java/com/example/doctor/app/PublicVariables.java b/app/src/main/java/com/example/doctor/app/PublicVariables.java
deleted file mode 100644
--- a/app/src/main/java/com/example/doctor/app/PublicVariables.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,5 +0,0 @@
-package com.example.doctor.app;
-
-public class PublicVariables {
-    public static final String VIDEO_SDK_API_KEY = "fcde808e-f307-4185-8199-c59095ae0b7e";
-}
Index: app/src/main/res/values-night/themes.xml
===================================================================
diff --git a/app/src/main/res/values-night/themes.xml b/app/src/main/res/values-night/themes.xml
deleted file mode 100644
--- a/app/src/main/res/values-night/themes.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ /dev/null	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
@@ -1,16 +0,0 @@
-<resources xmlns:tools="http://schemas.android.com/tools">
-    <!-- Base application theme. -->
-    <style name="Theme.Doctor" parent="Theme.MaterialComponents.DayNight.DarkActionBar">
-        <!-- Primary brand color. -->
-        <item name="colorPrimary">@color/purple_200</item>
-        <item name="colorPrimaryVariant">@color/purple_700</item>
-        <item name="colorOnPrimary">@color/black</item>
-        <!-- Secondary brand color. -->
-        <item name="colorSecondary">@color/teal_200</item>
-        <item name="colorSecondaryVariant">@color/teal_200</item>
-        <item name="colorOnSecondary">@color/black</item>
-        <!-- Status bar color. -->
-        <item name="android:statusBarColor" tools:targetApi="l">?attr/colorPrimaryVariant</item>
-        <!-- Customize your theme here. -->
-    </style>
-</resources>
\ No newline at end of file
Index: app/src/main/res/drawable/rounded_rect_bg_selector.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/rounded_rect_bg_selector.xml b/app/src/main/res/drawable/rounded_rect_bg_selector.xml
new file mode 100644
--- /dev/null	(date 1670350097027)
+++ b/app/src/main/res/drawable/rounded_rect_bg_selector.xml	(date 1670350097027)
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="utf-8"?>
+<selector xmlns:android="http://schemas.android.com/apk/res/android">
+    <!-- Active tab -->
+    <item android:drawable="@drawable/rounded_rectangle_bg" android:state_focused="false" android:state_pressed="false" android:state_selected="true"/>
+    <!-- Inactive tab -->
+    <item android:drawable="@drawable/rounded_rectangle_bg" android:state_focused="false" android:state_pressed="false" android:state_selected="false"/>
+    <!-- Pressed tab -->
+    <item android:drawable="@drawable/rounded_rectangle_bg_selected" android:state_pressed="true"/>
+    <!-- Selected tab (using d-pad) -->
+    <item android:drawable="@drawable/rounded_rectangle_bg_selected" android:state_focused="true" android:state_pressed="false" android:state_selected="true"/>
+</selector>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/TagTree.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/TagTree.java b/app/src/main/java/com/shasthosheba/patient/TagTree.java
new file mode 100644
--- /dev/null	(date 1670269551096)
+++ b/app/src/main/java/com/shasthosheba/patient/TagTree.java	(date 1670269551096)
@@ -0,0 +1,30 @@
+package com.shasthosheba.patient;
+
+import org.jetbrains.annotations.NotNull;
+
+import timber.log.Timber;
+
+/**
+ * most of the codes other than getTag() are copied from {@link Timber.DebugTree}
+ * @author TanvirTaaha
+ * implementation 'com.jakewharton.timber:timber:4.7.1'
+ */
+public class TagTree extends Timber.DebugTree {
+    protected final String tagPrefix;
+    protected final boolean prefixTag;
+
+    public TagTree(String tagPrefix, boolean prefixTag) {
+        super();
+        this.tagPrefix = tagPrefix;
+        this.prefixTag = prefixTag;
+    }
+
+    @Override
+    protected void log(int priority, String tag, @NotNull String message, Throwable t) {
+        if (prefixTag) {
+            super.log(priority, tagPrefix + "-" + tag, message, t);
+        } else {
+            super.log(priority, tagPrefix, message, t);
+        }
+    }
+}
Index: app/src/main/java/com/shasthosheba/patient/StartActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/StartActivity.java b/app/src/main/java/com/shasthosheba/patient/StartActivity.java
new file mode 100644
--- /dev/null	(date 1670582798412)
+++ b/app/src/main/java/com/shasthosheba/patient/StartActivity.java	(date 1670582798412)
@@ -0,0 +1,207 @@
+package com.shasthosheba.patient;
+
+import android.content.Intent;
+import android.os.Bundle;
+import android.view.View;
+import android.widget.Toast;
+
+import androidx.activity.result.ActivityResultLauncher;
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.core.app.NotificationChannelCompat;
+import androidx.core.app.NotificationManagerCompat;
+
+import com.firebase.ui.auth.AuthUI;
+import com.firebase.ui.auth.FirebaseAuthUIActivityResultContract;
+import com.firebase.ui.auth.IdpResponse;
+import com.firebase.ui.auth.data.model.FirebaseAuthUIAuthenticationResult;
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.auth.FirebaseUser;
+import com.google.firebase.database.DataSnapshot;
+import com.google.firebase.database.DatabaseError;
+import com.google.firebase.database.DatabaseReference;
+import com.google.firebase.database.FirebaseDatabase;
+import com.google.firebase.database.ValueEventListener;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.shasthosheba.patient.app.PreferenceManager;
+import com.shasthosheba.patient.app.PublicVariables;
+import com.shasthosheba.patient.databinding.ActivityStartBinding;
+import com.shasthosheba.patient.model.Intermediary;
+import com.shasthosheba.patient.model.User;
+import com.shasthosheba.patient.util.Utils;
+
+import org.jitsi.meet.sdk.JitsiMeet;
+import org.jitsi.meet.sdk.JitsiMeetConferenceOptions;
+
+import java.net.MalformedURLException;
+import java.net.URL;
+import java.util.ArrayList;
+import java.util.Arrays;
+import java.util.List;
+
+import timber.log.Timber;
+
+public class StartActivity extends AppCompatActivity {
+
+
+    private final ActivityResultLauncher<Intent> signInLauncher = registerForActivityResult(
+            new FirebaseAuthUIActivityResultContract(),
+            this::onSignInResult
+    );
+
+    private User mUser;
+    private PreferenceManager preferenceManager;
+
+    private void onSignInResult(FirebaseAuthUIAuthenticationResult result) {
+        IdpResponse response = result.getIdpResponse();
+        if (result.getResultCode() == RESULT_OK) {
+            //Successfully signed in
+            handleAfterSignIn();
+            Timber.d("Logged in");
+        } else {
+            if (response != null) {
+                Toast.makeText(this, "Something went wrong", Toast.LENGTH_LONG).show();
+                Timber.d(response.getError());
+            }
+        }
+    }
+
+    private FirebaseDatabase rtDB = FirebaseDatabase.getInstance(PublicVariables.FIREBASE_DB);
+    private DatabaseReference dataRef = rtDB.getReference(PublicVariables.INTERMEDIARY_KEY);
+    private DatabaseReference callRef = rtDB.getReference("call");
+    private DatabaseReference conRef = rtDB.getReference(".info/connected");
+
+    private ActivityStartBinding binding;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        binding = ActivityStartBinding.inflate(getLayoutInflater());
+        setContentView(binding.getRoot());
+        preferenceManager = new PreferenceManager(this);
+
+
+        List<AuthUI.IdpConfig> providers = Arrays.asList(
+                new AuthUI.IdpConfig.EmailBuilder().build(),
+                new AuthUI.IdpConfig.GoogleBuilder().build()
+        );
+        Intent signInIntent = AuthUI.getInstance()
+                .createSignInIntentBuilder()
+                .setAlwaysShowSignInMethodScreen(true)
+                .setIsSmartLockEnabled(false)
+                .setAvailableProviders(providers)
+                .build();
+
+        createNotificationChannel();
+
+        FirebaseAuth.getInstance().addAuthStateListener(firebaseAuth -> {
+            if (firebaseAuth.getCurrentUser() == null) { // not signed in
+                Timber.i("Launching sign in launcher");
+                signInLauncher.launch(signInIntent);
+            } else { // signed in
+                handleAfterSignIn();
+            }
+        });
+
+
+        URL serverUrl;
+        try {
+            serverUrl = new URL("https://meet.jit.si");
+            JitsiMeetConferenceOptions defaultOptions = new JitsiMeetConferenceOptions.Builder()
+                    .setServerURL(serverUrl)
+                    .setFeatureFlag("welcomepage.enabled", false)
+                    .build();
+            JitsiMeet.setDefaultConferenceOptions(defaultOptions);
+        } catch (MalformedURLException e) {
+            e.printStackTrace();
+        }
+
+    }
+
+    private boolean passed = false;
+
+    private void handleAfterSignIn() {
+        if (!preferenceManager.isConnected()) {
+            Timber.d("Not connected");
+            passed = false;
+            binding.progressBar.setVisibility(View.INVISIBLE);
+            binding.tvConnecting.setText(R.string.connection_lost);
+            return;
+        }
+        passed = true;
+        Timber.d("inside handle sign in function");
+        FirebaseUser firebaseUser = FirebaseAuth.getInstance().getCurrentUser();
+        mUser = new User(firebaseUser.getUid(), firebaseUser.getDisplayName(), "online");
+        dataRef.child(firebaseUser.getUid()).setValue(mUser);
+//        Toast.makeText(StartActivity.this, "Signed in successfully", Toast.LENGTH_LONG).show();
+
+        preferenceManager.setUser(mUser);
+        conRef.addValueEventListener(new ValueEventListener() {
+            @Override
+            public void onDataChange(@NonNull DataSnapshot snapshot) {
+                Timber.d(".info/connected:%s", snapshot.getValue());
+                if (Boolean.FALSE.equals(snapshot.getValue(Boolean.class))) { //NOT CONNECTED
+                    User usr = new User(mUser.getuId(), mUser.getName(), "offline");
+                    dataRef.child(mUser.getuId()).onDisconnect().setValue(usr);
+                }
+                preferenceManager.setConnected(Boolean.TRUE.equals(snapshot.getValue(Boolean.class)));
+                if (!passed) {
+                    handleAfterSignIn();
+                }
+            }
+
+            @Override
+            public void onCancelled(@NonNull DatabaseError error) {
+                Timber.e(error.toException());
+            }
+        });
+
+        FirebaseFirestore firestore = FirebaseFirestore.getInstance();
+        firestore.collection(PublicVariables.INTERMEDIARY_KEY).document(mUser.getuId()).get()
+                .addOnSuccessListener(documentSnapshot -> {
+                    Timber.d("dddddddddddd");
+                    if (documentSnapshot != null && documentSnapshot.exists()) {
+                        Timber.d("checking for existence of intermediary:%s", documentSnapshot.getData());
+                        preferenceManager.setIntermediary(documentSnapshot.toObject(Intermediary.class));
+                        Timber.d("checking whether intermediary at pref_Man is null:%s", preferenceManager.getIntermediary());
+                        startActivity(new Intent(StartActivity.this, MainActivity.class));
+                    } else {
+                        //No data found
+                        Timber.d("No data found");
+                        Timber.d("[should be null]checking for existence of intermediary:%s", documentSnapshot.getData());
+                        Intermediary intermediary = new Intermediary();
+                        intermediary.setId(mUser.getuId());
+                        intermediary.setName(mUser.getName());
+                        intermediary.setPatients(new ArrayList<>());
+                        firestore.collection(PublicVariables.INTERMEDIARY_KEY).document(mUser.getuId()).set(intermediary)
+                                .addOnSuccessListener(unused -> {
+                                    Timber.d("Added new data:%s", intermediary);
+                                    preferenceManager.setIntermediary(intermediary);
+                                    startActivity(new Intent(StartActivity.this, MainActivity.class));
+                                }).addOnFailureListener(Timber::e);
+                    }
+                    Timber.d("Document:%s", documentSnapshot.getData());
+                })
+                .addOnFailureListener(Timber::e);
+    }
+
+    @Override
+    protected void onResume() {
+        super.onResume();
+        Utils.setStatusOnline(this);
+        handleAfterSignIn();
+    }
+
+    private void createNotificationChannel() {
+        Timber.v("Creating notification channel");
+        CharSequence name = "Call";
+        String description = "Audio and video call";
+        int importance = NotificationManagerCompat.IMPORTANCE_MAX;
+        NotificationChannelCompat channel = new NotificationChannelCompat.Builder(PublicVariables.CHANNEL_ID, importance)
+                .setName(name)
+                .setDescription(description)
+                .build();
+        NotificationManagerCompat notificationManager = NotificationManagerCompat.from(StartActivity.this);
+        notificationManager.createNotificationChannel(channel);
+    }
+}
\ No newline at end of file
Index: app/src/main/res/layout/med_and_test_view_item.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/med_and_test_view_item.xml b/app/src/main/res/layout/med_and_test_view_item.xml
new file mode 100644
--- /dev/null	(date 1670582116715)
+++ b/app/src/main/res/layout/med_and_test_view_item.xml	(date 1670582116715)
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="utf-8"?>
+<TextView xmlns:android="http://schemas.android.com/apk/res/android"
+    android:id="@+id/tv_text"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:textAppearance="?android:attr/textAppearanceListItemSmall"
+    android:gravity="center_vertical"
+    android:textColor="@android:color/primary_text_light"
+    android:paddingStart="?android:attr/listPreferredItemPaddingStart"
+    android:paddingEnd="?android:attr/listPreferredItemPaddingEnd"
+    android:minHeight="?android:attr/listPreferredItemHeightSmall" />
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/BroadcastReceiver.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/BroadcastReceiver.java b/app/src/main/java/com/shasthosheba/patient/BroadcastReceiver.java
new file mode 100644
--- /dev/null	(date 1670427860400)
+++ b/app/src/main/java/com/shasthosheba/patient/BroadcastReceiver.java	(date 1670427860400)
@@ -0,0 +1,35 @@
+package com.shasthosheba.patient;
+
+import android.content.Context;
+import android.content.Intent;
+
+import androidx.core.app.NotificationManagerCompat;
+
+import com.shasthosheba.patient.app.IntentTags;
+import com.shasthosheba.patient.app.PublicVariables;
+import com.shasthosheba.patient.model.Call;
+import com.google.firebase.database.FirebaseDatabase;
+
+import org.jitsi.meet.sdk.JitsiMeetActivity;
+import org.jitsi.meet.sdk.JitsiMeetConferenceOptions;
+
+public class BroadcastReceiver extends android.content.BroadcastReceiver {
+    @Override
+    public void onReceive(Context context, Intent intent) {
+        if (intent.getAction().equals(IntentTags.ACTION_ACCEPT.tag)) {
+            Call call = (Call) intent.getSerializableExtra(IntentTags.CALL_OBJ.tag);
+            JitsiMeetConferenceOptions options = new JitsiMeetConferenceOptions.Builder()
+                    .setRoom(call.getRoom())
+                    .setVideoMuted(!call.isVideo())
+                    .build();
+            JitsiMeetActivity.launch(context, options);
+            FirebaseDatabase.getInstance(PublicVariables.FIREBASE_DB).getReference("call").child(call.getRoom()).removeValue();
+            NotificationManagerCompat.from(context).cancel(PublicVariables.CALL_NOTIFICATION_ID);
+        }
+        if (intent.getAction().equals(IntentTags.ACTION_REJECT.tag)) {
+            Call call = (Call) intent.getSerializableExtra(IntentTags.CALL_OBJ.tag);
+            FirebaseDatabase.getInstance(PublicVariables.FIREBASE_DB).getReference("call").child(call.getRoom()).removeValue();
+            NotificationManagerCompat.from(context).cancel(PublicVariables.CALL_NOTIFICATION_ID);
+        }
+    }
+}
Index: app/src/androidTest/java/com/example/doctor/ExampleInstrumentedTest.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/androidTest/java/com/example/doctor/ExampleInstrumentedTest.java b/app/src/androidTest/java/com/shasthosheba/patient/ExampleInstrumentedTest.java
rename from app/src/androidTest/java/com/example/doctor/ExampleInstrumentedTest.java
rename to app/src/androidTest/java/com/shasthosheba/patient/ExampleInstrumentedTest.java
--- a/app/src/androidTest/java/com/example/doctor/ExampleInstrumentedTest.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/src/androidTest/java/com/shasthosheba/patient/ExampleInstrumentedTest.java	(date 1670269551093)
@@ -1,4 +1,4 @@
-package com.example.doctor;
+package com.shasthosheba.patient;
 
 import android.content.Context;
 
Index: app/src/main/java/com/shasthosheba/patient/patient/PatientAdapter.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/patient/PatientAdapter.java b/app/src/main/java/com/shasthosheba/patient/patient/PatientAdapter.java
new file mode 100644
--- /dev/null	(date 1670582993134)
+++ b/app/src/main/java/com/shasthosheba/patient/patient/PatientAdapter.java	(date 1670582993134)
@@ -0,0 +1,67 @@
+package com.shasthosheba.patient.patient;
+
+import android.content.Intent;
+import android.view.LayoutInflater;
+import android.view.ViewGroup;
+import android.widget.Toast;
+
+import androidx.annotation.NonNull;
+import androidx.recyclerview.widget.RecyclerView;
+
+import com.shasthosheba.patient.app.IntentTags;
+import com.shasthosheba.patient.databinding.RcvPatientItemBinding;
+import com.shasthosheba.patient.model.Patient;
+
+import java.util.Calendar;
+import java.util.GregorianCalendar;
+import java.util.List;
+
+import timber.log.Timber;
+
+public class PatientAdapter extends RecyclerView.Adapter<PatientAdapter.PatientViewHolder> {
+    private final List<Patient> mList;
+
+    public PatientAdapter(List<Patient> list) {
+        this.mList = list;
+    }
+
+    public List<Patient> getList() {
+        return this.mList;
+    }
+
+    @NonNull
+    @Override
+    public PatientViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+        return new PatientViewHolder(RcvPatientItemBinding.inflate(LayoutInflater.from(parent.getContext()), parent, false));
+    }
+
+    @Override
+    public void onBindViewHolder(@NonNull PatientViewHolder holder, int position) {
+        Patient patient = mList.get(position);
+        Calendar calendar = new GregorianCalendar();
+        int age = calendar.get(Calendar.YEAR) - patient.getBirthYear();
+        holder.binding.tvAge.setText(String.valueOf(age));
+        holder.binding.tvName.setText(patient.getName());
+        holder.binding.llRoot.setOnClickListener(v -> {
+            v.getContext().startActivity(new Intent(v.getContext(), PatientDetailsActivity.class)
+                    .putExtra(IntentTags.PATIENT_OBJ.tag, patient.toString()));
+//            Toast.makeText(v.getContext(), patient.getId(), Toast.LENGTH_LONG).show();
+            Timber.d("Patient clicked:%s", patient);
+        });
+    }
+
+    @Override
+    public int getItemCount() {
+        return mList.size();
+    }
+
+    protected static class PatientViewHolder extends RecyclerView.ViewHolder {
+        protected RcvPatientItemBinding binding;
+
+        protected PatientViewHolder(@NonNull RcvPatientItemBinding binding) {
+            super(binding.getRoot());
+            this.binding = binding;
+
+        }
+    }
+}
Index: .idea/deploymentTargetDropDown.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/deploymentTargetDropDown.xml b/.idea/deploymentTargetDropDown.xml
new file mode 100644
--- /dev/null	(date 1670582725715)
+++ b/.idea/deploymentTargetDropDown.xml	(date 1670582725715)
@@ -0,0 +1,17 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="deploymentTargetDropDown">
+    <targetSelectedWithDropDown>
+      <Target>
+        <type value="QUICK_BOOT_TARGET" />
+        <deviceKey>
+          <Key>
+            <type value="VIRTUAL_DEVICE_PATH" />
+            <value value="$USER_HOME$/.android/avd/Pixel_4_API_Tiramisu.avd" />
+          </Key>
+        </deviceKey>
+      </Target>
+    </targetSelectedWithDropDown>
+    <timeTargetWasSelectedWithDropDown value="2022-12-09T10:45:22.111997Z" />
+  </component>
+</project>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/patient/PatientDetailsActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/patient/PatientDetailsActivity.java b/app/src/main/java/com/shasthosheba/patient/patient/PatientDetailsActivity.java
new file mode 100644
--- /dev/null	(date 1670583794995)
+++ b/app/src/main/java/com/shasthosheba/patient/patient/PatientDetailsActivity.java	(date 1670583794995)
@@ -0,0 +1,157 @@
+package com.shasthosheba.patient.patient;
+
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.recyclerview.widget.LinearLayoutManager;
+import androidx.recyclerview.widget.RecyclerView;
+
+import android.annotation.SuppressLint;
+import android.app.AlertDialog;
+import android.content.Intent;
+import android.os.Bundle;
+import android.view.ViewGroup;
+import android.widget.Toast;
+
+import com.google.android.gms.tasks.OnSuccessListener;
+import com.google.android.material.snackbar.Snackbar;
+import com.google.firebase.firestore.DocumentSnapshot;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.google.gson.Gson;
+import com.shasthosheba.patient.app.IntentTags;
+import com.shasthosheba.patient.app.PreferenceManager;
+import com.shasthosheba.patient.app.PublicVariables;
+import com.shasthosheba.patient.databinding.ActivityPatientDetailsBinding;
+import com.shasthosheba.patient.databinding.RcvPresTitleItemBinding;
+import com.shasthosheba.patient.model.Intermediary;
+import com.shasthosheba.patient.model.Patient;
+import com.shasthosheba.patient.model.Prescription;
+import com.shasthosheba.patient.model.User;
+
+import java.util.ArrayList;
+import java.util.Calendar;
+import java.util.GregorianCalendar;
+import java.util.List;
+import java.util.Objects;
+
+import dmax.dialog.SpotsDialog;
+import timber.log.Timber;
+
+public class PatientDetailsActivity extends AppCompatActivity {
+
+    private ActivityPatientDetailsBinding binding;
+    private Patient patient;
+    private FirebaseFirestore firestore = FirebaseFirestore.getInstance();
+    private PrescriptionTitleAdapter adapter;
+
+    private String intermediaryId;
+    boolean fetchDone = true;
+    private AlertDialog alertDialog;
+    private PreferenceManager preferenceManager;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        binding = ActivityPatientDetailsBinding.inflate(getLayoutInflater());
+        setContentView(binding.getRoot());
+        preferenceManager = new PreferenceManager(this);
+        alertDialog = new SpotsDialog.Builder().setContext(this).setMessage("Loading...").build();
+        if (!getIntent().hasExtra(IntentTags.PATIENT_OBJ.tag)) {
+            Timber.e("No patient data in intent");
+            Snackbar.make(binding.getRoot(), "Something went wrong", Snackbar.LENGTH_LONG).show();
+            finish();
+        }
+        patient = new Gson().fromJson(getIntent().getStringExtra(IntentTags.PATIENT_OBJ.tag), Patient.class);
+
+        intermediaryId = preferenceManager.getIntermediary().getId();
+
+        binding.tvPatientName.setText(patient.getName());
+        int age = new GregorianCalendar().get(Calendar.YEAR) - patient.getBirthYear();
+        binding.tvPatientAge.setText(String.valueOf(age));
+
+        adapter = new PrescriptionTitleAdapter(new ArrayList<>());
+        binding.rcvPrescription.setLayoutManager(new LinearLayoutManager(this));
+        binding.rcvPrescription.setAdapter(adapter);
+
+        fetchAllPrescriptions();
+    }
+
+    @SuppressLint("NotifyDataSetChanged")
+    private void fetchAllPrescriptions() {
+        alertDialog.show();
+        firestore.collection(PublicVariables.PATIENTS_KEY).document(patient.getId()).get()
+                .addOnSuccessListener(documentSnapshotPatient -> {
+                    List<String> prescriptionIds = Objects.requireNonNull(documentSnapshotPatient.toObject(Patient.class)).getPrescriptionIds();
+                    if (prescriptionIds == null || prescriptionIds.isEmpty()) {
+                        Timber.d("prescription list empty");
+                        return;
+                    }
+                    fetchDone = false;
+
+
+                    adapter.mList.clear();
+                    Timber.d("adapter cleared:%s", adapter.getItemCount());
+                    for (String presId : prescriptionIds) {
+                        Timber.d("prescription id list:%s", prescriptionIds);
+                        firestore.collection(PublicVariables.PRESCRIPTION_KEY).document(presId).get()
+                                .addOnSuccessListener(documentSnapshot -> {
+                                    Prescription fetchedPrescription = documentSnapshot.toObject(Prescription.class);
+                                    Timber.d("fetched prescription:%s", fetchedPrescription);
+                                    if (!adapter.mList.contains(fetchedPrescription)) {
+                                        adapter.mList.add(fetchedPrescription);
+                                        adapter.notifyItemInserted(adapter.getItemCount() - 1);
+                                        fetchDone = true;
+                                        alertDialog.dismiss();
+                                    }
+                                })
+                                .addOnFailureListener(Timber::e);
+                    }
+                    adapter.notifyDataSetChanged();
+                })
+                .addOnFailureListener(Timber::e);
+    }
+
+    private class PrescriptionTitleAdapter extends RecyclerView.Adapter<PrescriptionTitleAdapter.PresTitleViewHolder> {
+        private List<Prescription> mList;
+
+        public PrescriptionTitleAdapter(List<Prescription> mList) {
+            this.mList = mList;
+        }
+
+        public List<Prescription> getList() {
+            return mList;
+        }
+
+        @NonNull
+        @Override
+        public PresTitleViewHolder onCreateViewHolder(@NonNull ViewGroup parent, int viewType) {
+            return new PresTitleViewHolder(RcvPresTitleItemBinding.inflate(getLayoutInflater(), parent, false));
+        }
+
+        @Override
+        public void onBindViewHolder(@NonNull PresTitleViewHolder holder, int position) {
+            Prescription prescription = mList.get(position);
+            holder.binding.tvPresTitle.setText(prescription.getPrescriptionTitle());
+            holder.binding.llRoot.setOnClickListener(v -> {
+                if (fetchDone) {
+//                    Toast.makeText(v.getContext(), prescription.getPrescriptionTitle(), Toast.LENGTH_LONG).show();startActivity(new Intent(v.getContext(), PrescriptionViewActivity.class)
+                    startActivity(new Intent(v.getContext(), PrescriptionViewActivity.class)
+                            .putExtra(IntentTags.PRESCRIPTION_OBJ.tag, prescription.toString()));
+                }
+            });
+        }
+
+        @Override
+        public int getItemCount() {
+            return mList.size();
+        }
+
+        public class PresTitleViewHolder extends RecyclerView.ViewHolder {
+            RcvPresTitleItemBinding binding;
+
+            public PresTitleViewHolder(@NonNull RcvPresTitleItemBinding binding) {
+                super(binding.getRoot());
+                this.binding = binding;
+            }
+        }
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/model/User.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/model/User.java b/app/src/main/java/com/shasthosheba/patient/model/User.java
new file mode 100644
--- /dev/null	(date 1670344634727)
+++ b/app/src/main/java/com/shasthosheba/patient/model/User.java	(date 1670344634727)
@@ -0,0 +1,42 @@
+package com.shasthosheba.patient.model;
+
+import java.io.Serializable;
+
+public class User implements Serializable {
+    private String name;
+    private String status;
+    private String uId;
+
+    public User(String uId, String name, String status) {
+        this.uId = uId;
+        this.name = name;
+        this.status = status;
+    }
+
+    public User() {
+    }
+
+    public String getName() {
+        return name;
+    }
+
+    public void setName(String name) {
+        this.name = name;
+    }
+
+    public String getStatus() {
+        return status;
+    }
+
+    public void setStatus(String status) {
+        this.status = status;
+    }
+
+    public String getuId() {
+        return uId;
+    }
+
+    public void setuId(String uId) {
+        this.uId = uId;
+    }
+}
Index: app/src/main/java/com/shasthosheba/patient/model/Call.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/model/Call.java b/app/src/main/java/com/shasthosheba/patient/model/Call.java
new file mode 100644
--- /dev/null	(date 1670551494624)
+++ b/app/src/main/java/com/shasthosheba/patient/model/Call.java	(date 1670551494624)
@@ -0,0 +1,52 @@
+package com.shasthosheba.patient.model;
+
+import java.io.Serializable;
+
+public class Call extends BaseModel implements Serializable {
+    private String wants;
+    private boolean video;
+    private String room;
+    private String doctor;
+
+    public Call() {
+    }
+
+    public Call(String wants, boolean video, String room, String doctor) {
+        this.wants = wants;
+        this.video = video;
+        this.room = room;
+        this.doctor = doctor;
+    }
+
+    public boolean isVideo() {
+        return video;
+    }
+
+    public void setVideo(boolean video) {
+        this.video = video;
+    }
+
+    public String getWants() {
+        return wants;
+    }
+
+    public void setWants(String wants) {
+        this.wants = wants;
+    }
+
+    public String getRoom() {
+        return room;
+    }
+
+    public void setRoom(String room) {
+        this.room = room;
+    }
+
+    public String getDoctor() {
+        return doctor;
+    }
+
+    public void setDoctor(String doctor) {
+        this.doctor = doctor;
+    }
+}
Index: app/src/main/res/layout/rcv_pres_title_item.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/rcv_pres_title_item.xml b/app/src/main/res/layout/rcv_pres_title_item.xml
new file mode 100644
--- /dev/null	(date 1670579357036)
+++ b/app/src/main/res/layout/rcv_pres_title_item.xml	(date 1670579357036)
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.appcompat.widget.LinearLayoutCompat xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:background="@drawable/rounded_rect_bg_selector"
+    android:orientation="vertical"
+    android:padding="8dp"
+    android:id="@+id/ll_root"
+    android:layout_marginVertical="4dp">
+
+    <TextView
+        android:id="@+id/tv_pres_title"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_gravity="center_horizontal"
+        android:textColor="@android:color/primary_text_light"
+        android:textSize="18sp"
+        tools:text="John_DEC_12_2022" />
+</androidx.appcompat.widget.LinearLayoutCompat>
\ No newline at end of file
Index: .idea/render.experimental.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/render.experimental.xml b/.idea/render.experimental.xml
new file mode 100644
--- /dev/null	(date 1670349195233)
+++ b/.idea/render.experimental.xml	(date 1670349195233)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="RenderSettings">
+    <option name="showDecorations" value="true" />
+  </component>
+</project>
\ No newline at end of file
Index: app/src/main/res/layout/activity_prescription_view.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_prescription_view.xml b/app/src/main/res/layout/activity_prescription_view.xml
new file mode 100644
--- /dev/null	(date 1670583571923)
+++ b/app/src/main/res/layout/activity_prescription_view.xml	(date 1670583571923)
@@ -0,0 +1,136 @@
+<?xml version="1.0" encoding="utf-8"?>
+<ScrollView xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@drawable/patient_background_low_opacity"
+    android:fillViewport="true"
+    tools:context=".patient.PrescriptionViewActivity">
+
+    <androidx.appcompat.widget.LinearLayoutCompat
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="vertical"
+        android:padding="16dp">
+
+        <androidx.appcompat.widget.LinearLayoutCompat
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:background="@drawable/rounded_rectangle_bg"
+            android:gravity="center"
+            android:orientation="horizontal"
+            android:paddingVertical="8dp">
+
+            <TextView
+                android:id="@+id/tv_doc_title"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_marginEnd="8dp"
+                android:text="@string/doctor"
+                android:textColor="@android:color/primary_text_light"
+                android:textSize="18sp" />
+
+            <TextView
+                android:id="@+id/tv_doc_name"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:textColor="@android:color/primary_text_light"
+                android:textSize="18sp"
+                tools:text="John" />
+        </androidx.appcompat.widget.LinearLayoutCompat>
+
+        <androidx.appcompat.widget.LinearLayoutCompat
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:layout_marginTop="8dp"
+            android:background="@drawable/rounded_rectangle_bg"
+            android:gravity="center"
+            android:orientation="horizontal"
+            android:paddingVertical="8dp">
+
+            <TextView
+                android:id="@+id/tv_patient_title"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:layout_marginEnd="8dp"
+                android:text="@string/patient"
+                android:textColor="@android:color/primary_text_light"
+                android:textSize="18sp" />
+
+            <TextView
+                android:id="@+id/tv_patient_name"
+                android:layout_width="wrap_content"
+                android:layout_height="wrap_content"
+                android:textColor="@android:color/primary_text_light"
+                android:textSize="18sp"
+                tools:text="John" />
+        </androidx.appcompat.widget.LinearLayoutCompat>
+
+        <TextView
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_margin="8dp"
+            android:textColor="@android:color/primary_text_light"
+            android:text="@string/illness"
+            android:textSize="16sp"
+            android:textStyle="bold" />
+
+        <TextView
+            android:id="@+id/tv_illness_desc"
+            android:layout_width="match_parent"
+            android:textColor="@android:color/primary_text_light"
+            android:layout_height="wrap_content"
+            android:background="@drawable/rounded_rectangle_bg"
+            android:padding="8dp" />
+
+        <TextView
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_margin="8dp"
+            android:textColor="@android:color/primary_text_light"
+            android:text="@string/medicines"
+            android:textSize="20sp"
+            android:textStyle="bold" />
+
+        <ListView
+            android:id="@+id/lv_medicine_list"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:textColor="@android:color/primary_text_light"
+            android:background="@drawable/rounded_rectangle_bg" />
+
+        <TextView
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_margin="8dp"
+            android:textColor="@android:color/primary_text_light"
+            android:text="@string/tests"
+            android:textSize="20sp"
+            android:textStyle="bold" />
+
+        <ListView
+            android:id="@+id/lv_tests_list"
+            android:layout_width="match_parent"
+            android:textColor="@android:color/primary_text_light"
+            android:layout_height="wrap_content"
+            android:background="@drawable/rounded_rectangle_bg" />
+
+        <TextView
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_margin="8dp"
+            android:textColor="@android:color/primary_text_light"
+            android:text="@string/advice"
+            android:textSize="16sp"
+            android:textStyle="bold" />
+
+        <TextView
+            android:id="@+id/tv_advice"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:textColor="@android:color/primary_text_light"
+            android:background="@drawable/rounded_rectangle_bg"
+            android:padding="8dp" />
+    </androidx.appcompat.widget.LinearLayoutCompat>
+</ScrollView>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/app/PublicVariables.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/app/PublicVariables.java b/app/src/main/java/com/shasthosheba/patient/app/PublicVariables.java
new file mode 100644
--- /dev/null	(date 1670580471963)
+++ b/app/src/main/java/com/shasthosheba/patient/app/PublicVariables.java	(date 1670580471963)
@@ -0,0 +1,10 @@
+package com.shasthosheba.patient.app;
+
+public class PublicVariables {
+    public static final String FIREBASE_DB = "https://shasthosheba-fe3e1-default-rtdb.asia-southeast1.firebasedatabase.app";
+    public static final int CALL_NOTIFICATION_ID = 99;
+    public static final String CHANNEL_ID = "notification_channel";
+    public static final String INTERMEDIARY_KEY="intermediaries";
+    public static final String PATIENTS_KEY="patients";
+    public static final String PRESCRIPTION_KEY="prescriptions";
+}
Index: app/src/main/res/layout/rcv_patient_item.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/rcv_patient_item.xml b/app/src/main/res/layout/rcv_patient_item.xml
new file mode 100644
--- /dev/null	(date 1670504490058)
+++ b/app/src/main/res/layout/rcv_patient_item.xml	(date 1670504490058)
@@ -0,0 +1,62 @@
+<?xml version="1.0" encoding="utf-8"?>
+<androidx.appcompat.widget.LinearLayoutCompat xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="wrap_content"
+    android:id="@+id/ll_root"
+    android:layout_marginVertical="4dp"
+    android:background="@drawable/rounded_rect_bg_selector"
+    android:orientation="vertical">
+
+    <androidx.appcompat.widget.LinearLayoutCompat
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="horizontal">
+
+        <TextView
+            android:id="@+id/tv_name_title"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_margin="16dp"
+            android:text="Name:"
+            android:textColor="@android:color/secondary_text_light"
+            android:textSize="20sp"
+            android:textStyle="bold" />
+
+        <TextView
+            android:id="@+id/tv_name"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_marginVertical="16dp"
+            android:textColor="@android:color/primary_text_light"
+            android:textSize="20sp"
+            tools:text="John" />
+    </androidx.appcompat.widget.LinearLayoutCompat>
+
+    <androidx.appcompat.widget.LinearLayoutCompat
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:orientation="horizontal">
+
+        <TextView
+            android:id="@+id/tv_age_title"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_below="@id/tv_name_title"
+            android:layout_marginHorizontal="16dp"
+            android:layout_marginBottom="16dp"
+            android:text="Age:"
+            android:textColor="@android:color/secondary_text_light"
+            android:textSize="20sp"
+            android:textStyle="bold" />
+
+        <TextView
+            android:id="@+id/tv_age"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:textColor="@android:color/primary_text_light"
+            android:textSize="20sp"
+            tools:text="20" />
+
+    </androidx.appcompat.widget.LinearLayoutCompat>
+</androidx.appcompat.widget.LinearLayoutCompat>
\ No newline at end of file
Index: app/src/main/res/drawable/rounded_rectangle_bg.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/rounded_rectangle_bg.xml b/app/src/main/res/drawable/rounded_rectangle_bg.xml
new file mode 100644
--- /dev/null	(date 1670350678272)
+++ b/app/src/main/res/drawable/rounded_rectangle_bg.xml	(date 1670350678272)
@@ -0,0 +1,9 @@
+<?xml version="1.0" encoding="utf-8"?>
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <corners android:radius="8dp" />
+    <stroke
+        android:width="2dp"
+        android:color="@android:color/holo_blue_dark" />
+
+</shape>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/app/IntentTags.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/app/IntentTags.java b/app/src/main/java/com/shasthosheba/patient/app/IntentTags.java
new file mode 100644
--- /dev/null	(date 1670582993131)
+++ b/app/src/main/java/com/shasthosheba/patient/app/IntentTags.java	(date 1670582993131)
@@ -0,0 +1,15 @@
+package com.shasthosheba.patient.app;
+
+public enum IntentTags {
+    CALL_OBJ("call_object"),
+    ACTION_ACCEPT("Jitsi_call_accept"),
+    ACTION_REJECT("Jitsi_call_reject"),
+    PATIENT_OBJ("patient_object"),
+    PRESCRIPTION_OBJ("prescription_object"),
+    ;
+    public final String tag;
+
+    private IntentTags(String tag) {
+        this.tag = tag;
+    }
+}
Index: app/src/main/java/com/shasthosheba/patient/patient/PrescriptionViewActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/patient/PrescriptionViewActivity.java b/app/src/main/java/com/shasthosheba/patient/patient/PrescriptionViewActivity.java
new file mode 100644
--- /dev/null	(date 1670583571930)
+++ b/app/src/main/java/com/shasthosheba/patient/patient/PrescriptionViewActivity.java	(date 1670583571930)
@@ -0,0 +1,38 @@
+package com.shasthosheba.patient.patient;
+
+import android.os.Bundle;
+import android.widget.ArrayAdapter;
+
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.google.android.material.snackbar.Snackbar;
+import com.google.gson.Gson;
+import com.shasthosheba.patient.R;
+import com.shasthosheba.patient.app.IntentTags;
+import com.shasthosheba.patient.databinding.ActivityPrescriptionViewBinding;
+import com.shasthosheba.patient.model.Prescription;
+
+public class PrescriptionViewActivity extends AppCompatActivity {
+    private ActivityPrescriptionViewBinding binding;
+    private Prescription prescription;
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        binding = ActivityPrescriptionViewBinding.inflate(getLayoutInflater());
+        setContentView(binding.getRoot());
+
+        if (!getIntent().hasExtra(IntentTags.PRESCRIPTION_OBJ.tag)) {
+            Snackbar.make(binding.getRoot(), "Something went wrong", Snackbar.LENGTH_LONG).show();
+            finish();
+        }
+
+        prescription = new Gson().fromJson(getIntent().getStringExtra(IntentTags.PRESCRIPTION_OBJ.tag), Prescription.class);
+
+        binding.tvDocName.setText(prescription.getDoctorName());
+        binding.tvPatientName.setText(prescription.getPatientName());
+        binding.tvIllnessDesc.setText((prescription.getIllnessDescription()));
+        binding.lvMedicineList.setAdapter(new ArrayAdapter<>(this, R.layout.med_and_test_view_item, R.id.tv_text, prescription.getMedicines()));
+        binding.lvTestsList.setAdapter(new ArrayAdapter<>(this, R.layout.med_and_test_view_item, R.id.tv_text, prescription.getTests()));
+        binding.tvAdvice.setText(prescription.getAdvice());
+    }
+}
\ No newline at end of file
Index: app/src/main/res/drawable/rounded_rectangle_bg_selected.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/rounded_rectangle_bg_selected.xml b/app/src/main/res/drawable/rounded_rectangle_bg_selected.xml
new file mode 100644
--- /dev/null	(date 1670350674359)
+++ b/app/src/main/res/drawable/rounded_rectangle_bg_selected.xml	(date 1670350674359)
@@ -0,0 +1,9 @@
+<?xml version="1.0" encoding="utf-8"?>
+<shape xmlns:android="http://schemas.android.com/apk/res/android"
+    android:shape="rectangle">
+    <corners android:radius="8dp" />
+    <stroke
+        android:width="2dp"
+        android:color="@android:color/holo_blue_bright" />
+
+</shape>
\ No newline at end of file
Index: .idea/vcs.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/vcs.xml b/.idea/vcs.xml
new file mode 100644
--- /dev/null	(date 1670274443635)
+++ b/.idea/vcs.xml	(date 1670274443635)
@@ -0,0 +1,6 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project version="4">
+  <component name="VcsDirectoryMappings">
+    <mapping directory="" vcs="Git" />
+  </component>
+</project>
\ No newline at end of file
Index: app/google-services.json
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+>{\n  \"project_info\": {\n    \"project_number\": \"441651925791\",\n    \"project_id\": \"shasthosheba-fe3e1\",\n    \"storage_bucket\": \"shasthosheba-fe3e1.appspot.com\"\n  },\n  \"client\": [\n    {\n      \"client_info\": {\n        \"mobilesdk_app_id\": \"1:441651925791:android:4127d2b7dec5de01eb162a\",\n        \"android_client_info\": {\n          \"package_name\": \"com.example.doctor\"\n        }\n      },\n      \"oauth_client\": [\n        {\n          \"client_id\": \"441651925791-c04ck6ri10f8s0hgglb9skallalmgcnm.apps.googleusercontent.com\",\n          \"client_type\": 1,\n          \"android_info\": {\n            \"package_name\": \"com.example.doctor\",\n            \"certificate_hash\": \"888d590787ef221b242d6ae34db5e8bfbad25d04\"\n          }\n        },\n        {\n          \"client_id\": \"441651925791-b4rmt3kq2ilu2145954r18u2h1819ggm.apps.googleusercontent.com\",\n          \"client_type\": 3\n        }\n      ],\n      \"api_key\": [\n        {\n          \"current_key\": \"AIzaSyCK63LL5vl6dykxNyMt0OmOAFubfl2ykc8\"\n        }\n      ],\n      \"services\": {\n        \"appinvite_service\": {\n          \"other_platform_oauth_client\": [\n            {\n              \"client_id\": \"441651925791-b4rmt3kq2ilu2145954r18u2h1819ggm.apps.googleusercontent.com\",\n              \"client_type\": 3\n            }\n          ]\n        }\n      }\n    }\n  ],\n  \"configuration_version\": \"1\"\n}
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/google-services.json b/app/google-services.json
--- a/app/google-services.json	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/google-services.json	(date 1670302644265)
@@ -1,23 +1,61 @@
 {
   "project_info": {
     "project_number": "441651925791",
+    "firebase_url": "https://shasthosheba-fe3e1-default-rtdb.asia-southeast1.firebasedatabase.app",
     "project_id": "shasthosheba-fe3e1",
     "storage_bucket": "shasthosheba-fe3e1.appspot.com"
   },
   "client": [
     {
       "client_info": {
-        "mobilesdk_app_id": "1:441651925791:android:4127d2b7dec5de01eb162a",
+        "mobilesdk_app_id": "1:441651925791:android:bc3ea95d7cd0c741eb162a",
         "android_client_info": {
-          "package_name": "com.example.doctor"
+          "package_name": "com.shasthosheba.doctor"
         }
       },
       "oauth_client": [
         {
-          "client_id": "441651925791-c04ck6ri10f8s0hgglb9skallalmgcnm.apps.googleusercontent.com",
+          "client_id": "441651925791-na27919v6evn3t04dsbsc47qonqd65tr.apps.googleusercontent.com",
           "client_type": 1,
           "android_info": {
-            "package_name": "com.example.doctor",
+            "package_name": "com.shasthosheba.doctor",
+            "certificate_hash": "888d590787ef221b242d6ae34db5e8bfbad25d04"
+          }
+        },
+        {
+          "client_id": "441651925791-b4rmt3kq2ilu2145954r18u2h1819ggm.apps.googleusercontent.com",
+          "client_type": 3
+        }
+      ],
+      "api_key": [
+        {
+          "current_key": "AIzaSyCK63LL5vl6dykxNyMt0OmOAFubfl2ykc8"
+        }
+      ],
+      "services": {
+        "appinvite_service": {
+          "other_platform_oauth_client": [
+            {
+              "client_id": "441651925791-b4rmt3kq2ilu2145954r18u2h1819ggm.apps.googleusercontent.com",
+              "client_type": 3
+            }
+          ]
+        }
+      }
+    },
+    {
+      "client_info": {
+        "mobilesdk_app_id": "1:441651925791:android:25ecc685c5191c78eb162a",
+        "android_client_info": {
+          "package_name": "com.shasthosheba.patient"
+        }
+      },
+      "oauth_client": [
+        {
+          "client_id": "441651925791-89q1vsslnao47j5ahmbhrgb4jblrnb20.apps.googleusercontent.com",
+          "client_type": 1,
+          "android_info": {
+            "package_name": "com.shasthosheba.patient",
             "certificate_hash": "888d590787ef221b242d6ae34db5e8bfbad25d04"
           }
         },
Index: app/src/main/java/com/shasthosheba/patient/model/Prescription.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/model/Prescription.java b/app/src/main/java/com/shasthosheba/patient/model/Prescription.java
new file mode 100644
--- /dev/null	(date 1670557183527)
+++ b/app/src/main/java/com/shasthosheba/patient/model/Prescription.java	(date 1670557183527)
@@ -0,0 +1,136 @@
+package com.shasthosheba.patient.model;
+
+import java.util.List;
+
+public class Prescription extends BaseModel {
+    private String id;
+    private String prescriptionTitle;
+    private String doctorName;
+    private String doctorId;
+    private String patientName;
+    private String patientId;
+    private String intermediaryName;
+    private String intermediaryId;
+    private String illnessDescription;
+    private String advice;
+    private List<String> medicines;
+    private List<String> tests;
+
+    public Prescription(String id, String prescriptionTitle, String doctorName, String doctorId,
+                        String patientName, String patientId,
+                        String intermediaryName, String intermediaryId,
+                        String illnessDescription, String advice,
+                        List<String> medicines, List<String> tests) {
+        this.id = id;
+        this.prescriptionTitle = prescriptionTitle;
+        this.doctorName = doctorName;
+        this.doctorId = doctorId;
+        this.patientName = patientName;
+        this.patientId = patientId;
+        this.intermediaryName = intermediaryName;
+        this.intermediaryId = intermediaryId;
+        this.illnessDescription = illnessDescription;
+        this.advice = advice;
+        this.medicines = medicines;
+        this.tests = tests;
+    }
+
+    public Prescription() {
+    }
+
+    public String getDoctorName() {
+        return doctorName;
+    }
+
+    public void setDoctorName(String doctorName) {
+        this.doctorName = doctorName;
+    }
+
+    public String getDoctorId() {
+        return doctorId;
+    }
+
+    public void setDoctorId(String doctorId) {
+        this.doctorId = doctorId;
+    }
+
+    public String getPatientName() {
+        return patientName;
+    }
+
+    public void setPatientName(String patientName) {
+        this.patientName = patientName;
+    }
+
+    public String getPatientId() {
+        return patientId;
+    }
+
+    public void setPatientId(String patientId) {
+        this.patientId = patientId;
+    }
+
+    public String getIntermediaryName() {
+        return intermediaryName;
+    }
+
+    public void setIntermediaryName(String intermediaryName) {
+        this.intermediaryName = intermediaryName;
+    }
+
+    public String getIntermediaryId() {
+        return intermediaryId;
+    }
+
+    public void setIntermediaryId(String intermediaryId) {
+        this.intermediaryId = intermediaryId;
+    }
+
+    public String getIllnessDescription() {
+        return illnessDescription;
+    }
+
+    public void setIllnessDescription(String illnessDescription) {
+        this.illnessDescription = illnessDescription;
+    }
+
+    public String getAdvice() {
+        return advice;
+    }
+
+    public void setAdvice(String advice) {
+        this.advice = advice;
+    }
+
+    public List<String> getMedicines() {
+        return medicines;
+    }
+
+    public void setMedicines(List<String> medicines) {
+        this.medicines = medicines;
+    }
+
+    public List<String> getTests() {
+        return tests;
+    }
+
+    public void setTests(List<String> tests) {
+        this.tests = tests;
+    }
+
+    public String getId() {
+        return id;
+    }
+
+    public void setId(String id) {
+        this.id = id;
+    }
+
+    public String getPrescriptionTitle() {
+        return prescriptionTitle;
+    }
+
+    public void setPrescriptionTitle(String prescriptionTitle) {
+        this.prescriptionTitle = prescriptionTitle;
+    }
+}
Index: app/src/main/res/drawable/ic_notification.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_notification.xml b/app/src/main/res/drawable/ic_notification.xml
new file mode 100644
--- /dev/null	(date 1670220372228)
+++ b/app/src/main/res/drawable/ic_notification.xml	(date 1670220372228)
@@ -0,0 +1,15 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="108dp"
+    android:height="108dp"
+    android:viewportWidth="108"
+    android:viewportHeight="108"
+    android:tint="#000000">
+  <group android:scaleX="2.61"
+      android:scaleY="2.61"
+      android:translateX="22.68"
+      android:translateY="22.68">
+    <path
+        android:fillColor="@android:color/white"
+        android:pathData="M19.23,15.26l-2.54,-0.29c-0.61,-0.07 -1.21,0.14 -1.64,0.57l-1.84,1.84c-2.83,-1.44 -5.15,-3.75 -6.59,-6.59l1.85,-1.85c0.43,-0.43 0.64,-1.03 0.57,-1.64l-0.29,-2.52c-0.12,-1.01 -0.97,-1.77 -1.99,-1.77H5.03c-1.13,0 -2.07,0.94 -2,2.07 0.53,8.54 7.36,15.36 15.89,15.89 1.13,0.07 2.07,-0.87 2.07,-2v-1.73c0.01,-1.01 -0.75,-1.86 -1.76,-1.98z"/>
+  </group>
+</vector>
Index: app/src/main/res/drawable/ic_round_call_end_24.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_round_call_end_24.xml b/app/src/main/res/drawable/ic_round_call_end_24.xml
new file mode 100644
--- /dev/null	(date 1670226296702)
+++ b/app/src/main/res/drawable/ic_round_call_end_24.xml	(date 1670226296702)
@@ -0,0 +1,5 @@
+<vector android:height="24dp" android:tint="#FF0000"
+    android:viewportHeight="24" android:viewportWidth="24"
+    android:width="24dp" xmlns:android="http://schemas.android.com/apk/res/android">
+    <path android:fillColor="@android:color/white" android:pathData="M4.51,15.48l2,-1.59c0.48,-0.38 0.76,-0.96 0.76,-1.57v-2.6c3.02,-0.98 6.29,-0.99 9.32,0v2.61c0,0.61 0.28,1.19 0.76,1.57l1.99,1.58c0.8,0.63 1.94,0.57 2.66,-0.15l1.22,-1.22c0.8,-0.8 0.8,-2.13 -0.05,-2.88 -6.41,-5.66 -16.07,-5.66 -22.48,0 -0.85,0.75 -0.85,2.08 -0.05,2.88l1.22,1.22c0.71,0.72 1.85,0.78 2.65,0.15z"/>
+</vector>
Index: .idea/misc.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"UTF-8\"?>\n<project version=\"4\">\n  <component name=\"DesignSurface\">\n    <option name=\"filePathToZoomLevelMap\">\n      <map>\n        <entry key=\"app/src/main/res/layout/activity_start.xml\" value=\"0.31875\" />\n        <entry key=\"app/src/main/res/layout/activity_video_call.xml\" value=\"0.31875\" />\n        <entry key=\"app/src/main/res/layout/activity_video_call_test.xml\" value=\"0.3338541666666667\" />\n      </map>\n    </option>\n  </component>\n  <component name=\"ProjectRootManager\" version=\"2\" languageLevel=\"JDK_11\" default=\"true\" project-jdk-name=\"Android Studio default JDK\" project-jdk-type=\"JavaSDK\">\n    <output url=\"file://$PROJECT_DIR$/build/classes\" />\n  </component>\n  <component name=\"ProjectType\">\n    <option name=\"id\" value=\"Android\" />\n  </component>\n</project>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/.idea/misc.xml b/.idea/misc.xml
--- a/.idea/misc.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/.idea/misc.xml	(date 1670583928200)
@@ -3,9 +3,23 @@
   <component name="DesignSurface">
     <option name="filePathToZoomLevelMap">
       <map>
-        <entry key="app/src/main/res/layout/activity_start.xml" value="0.31875" />
-        <entry key="app/src/main/res/layout/activity_video_call.xml" value="0.31875" />
-        <entry key="app/src/main/res/layout/activity_video_call_test.xml" value="0.3338541666666667" />
+        <entry key="app/src/main/res/drawable/ic_logout.xml" value="0.1" />
+        <entry key="app/src/main/res/drawable/logout_48px.xml" value="0.1" />
+        <entry key="app/src/main/res/drawable/rounded_rect_bg_selector.xml" value="0.1" />
+        <entry key="app/src/main/res/drawable/rounded_rectangle_bg.xml" value="0.1" />
+        <entry key="app/src/main/res/drawable/rounder_rect_bg_selector.xml" value="0.1075" />
+        <entry key="app/src/main/res/drawable/rounder_rectangle_bg.xml" value="0.1075" />
+        <entry key="app/src/main/res/drawable/rounder_rectangle_bg_selected.xml" value="0.1075" />
+        <entry key="app/src/main/res/layout/activity_add_patient.xml" value="0.2703804347826087" />
+        <entry key="app/src/main/res/layout/activity_main.xml" value="0.25825825825825827" />
+        <entry key="app/src/main/res/layout/activity_patient_details.xml" value="0.14473684210526316" />
+        <entry key="app/src/main/res/layout/activity_prescription_view.xml" value="0.165" />
+        <entry key="app/src/main/res/layout/activity_sign.xml" value="0.171875" />
+        <entry key="app/src/main/res/layout/activity_start.xml" value="0.1453804347826087" />
+        <entry key="app/src/main/res/layout/med_and_test_view_item.xml" value="0.11956521739130435" />
+        <entry key="app/src/main/res/layout/rcv_patient_item.xml" value="0.165" />
+        <entry key="app/src/main/res/layout/rcv_pres_title_item.xml" value="0.14473684210526316" />
+        <entry key="app/src/main/res/menu/main_activity_menu.xml" value="0.3328125" />
       </map>
     </option>
   </component>
@@ -15,4 +29,11 @@
   <component name="ProjectType">
     <option name="id" value="Android" />
   </component>
+  <component name="VisualizationToolProject">
+    <option name="state">
+      <ProjectState>
+        <option name="scale" value="0.2703804347826087" />
+      </ProjectState>
+    </option>
+  </component>
 </project>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/model/BaseModel.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/model/BaseModel.java b/app/src/main/java/com/shasthosheba/patient/model/BaseModel.java
new file mode 100644
--- /dev/null	(date 1670499486783)
+++ b/app/src/main/java/com/shasthosheba/patient/model/BaseModel.java	(date 1670499486783)
@@ -0,0 +1,13 @@
+package com.shasthosheba.patient.model;
+
+import androidx.annotation.NonNull;
+
+import com.google.gson.Gson;
+
+public abstract class BaseModel {
+    @NonNull
+    @Override
+    public String toString() {
+        return new Gson().toJson(this);
+    }
+}
Index: app/src/main/res/values/themes.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><resources xmlns:tools=\"http://schemas.android.com/tools\">\n    <!-- Base application theme. -->\n    <style name=\"Theme.Doctor\" parent=\"Theme.MaterialComponents.DayNight.DarkActionBar\">\n        <!-- Primary brand color. -->\n        <item name=\"colorPrimary\">@color/purple_500</item>\n        <item name=\"colorPrimaryVariant\">@color/purple_700</item>\n        <item name=\"colorOnPrimary\">@color/white</item>\n        <!-- Secondary brand color. -->\n        <item name=\"colorSecondary\">@color/teal_200</item>\n        <item name=\"colorSecondaryVariant\">@color/teal_700</item>\n        <item name=\"colorOnSecondary\">@color/black</item>\n        <!-- Status bar color. -->\n        <item name=\"android:statusBarColor\" tools:targetApi=\"l\">?attr/colorPrimaryVariant</item>\n        <!-- Customize your theme here. -->\n    </style>\n</resources>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/themes.xml b/app/src/main/res/values/themes.xml
--- a/app/src/main/res/values/themes.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/src/main/res/values/themes.xml	(date 1670429385899)
@@ -1,6 +1,6 @@
 <resources xmlns:tools="http://schemas.android.com/tools">
     <!-- Base application theme. -->
-    <style name="Theme.Doctor" parent="Theme.MaterialComponents.DayNight.DarkActionBar">
+    <style name="Theme.Patient" parent="Theme.MaterialComponents.DayNight.DarkActionBar">
         <!-- Primary brand color. -->
         <item name="colorPrimary">@color/purple_500</item>
         <item name="colorPrimaryVariant">@color/purple_700</item>
@@ -12,5 +12,21 @@
         <!-- Status bar color. -->
         <item name="android:statusBarColor" tools:targetApi="l">?attr/colorPrimaryVariant</item>
         <!-- Customize your theme here. -->
+        <item name="backgroundImage">@drawable/patient_background_low_opacity</item>
+    </style>
+
+    <style name="Theme.Patient.NoActionBar" parent="Theme.MaterialComponents.NoActionBar">
+        <!-- Primary brand color. -->
+        <item name="colorPrimary">@color/purple_500</item>
+        <item name="colorPrimaryVariant">@color/purple_700</item>
+        <item name="colorOnPrimary">@color/white</item>
+        <!-- Secondary brand color. -->
+        <item name="colorSecondary">@color/teal_200</item>
+        <item name="colorSecondaryVariant">@color/teal_700</item>
+        <item name="colorOnSecondary">@color/black</item>
+        <!-- Status bar color. -->
+        <item name="android:statusBarColor" tools:targetApi="l">?attr/colorPrimaryVariant</item>
+        <!-- Customize your theme here. -->
+        <item name="backgroundImage">@drawable/patient_background_low_opacity</item>
     </style>
 </resources>
\ No newline at end of file
Index: app/src/main/res/drawable/ic_logout.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/drawable/ic_logout.xml b/app/src/main/res/drawable/ic_logout.xml
new file mode 100644
--- /dev/null	(date 1670428978150)
+++ b/app/src/main/res/drawable/ic_logout.xml	(date 1670428978150)
@@ -0,0 +1,9 @@
+<vector xmlns:android="http://schemas.android.com/apk/res/android"
+    android:width="48dp"
+    android:height="48dp"
+    android:viewportWidth="48"
+    android:viewportHeight="48">
+  <path
+      android:fillColor="#FF000000"
+      android:pathData="M8.75,42.5q-1.45,0 -2.55,-1.1 -1.1,-1.1 -1.1,-2.55L5.1,9.15q0,-1.45 1.1,-2.55 1.1,-1.1 2.55,-1.1h14.7v3.65L8.75,9.15v29.7h14.7v3.65ZM33.25,33.75 L30.55,31.1 35.85,25.8h-17.3v-3.65h17.2l-5.3,-5.3 2.7,-2.6 9.8,9.8Z"/>
+</vector>
Index: app/src/main/res/values/ic_launcher_background.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/values/ic_launcher_background.xml b/app/src/main/res/values/ic_launcher_background.xml
new file mode 100644
--- /dev/null	(date 1670220372223)
+++ b/app/src/main/res/values/ic_launcher_background.xml	(date 1670220372223)
@@ -0,0 +1,4 @@
+<?xml version="1.0" encoding="utf-8"?>
+<resources>
+    <color name="ic_launcher_background">#FFFFFF</color>
+</resources>
\ No newline at end of file
Index: gradle.properties
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+># Project-wide Gradle settings.\n# IDE (e.g. Android Studio) users:\n# Gradle settings configured through the IDE *will override*\n# any settings specified in this file.\n# For more details on how to configure your build environment visit\n# http://www.gradle.org/docs/current/userguide/build_environment.html\n# Specifies the JVM arguments used for the daemon process.\n# The setting is particularly useful for tweaking memory settings.\norg.gradle.jvmargs=-Xmx2048m -Dfile.encoding=UTF-8\n# When configured, Gradle will run in incubating parallel mode.\n# This option should only be used with decoupled projects. More details, visit\n# http://www.gradle.org/docs/current/userguide/multi_project_builds.html#sec:decoupled_projects\n# org.gradle.parallel=true\n# AndroidX package structure to make it clearer which packages are bundled with the\n# Android operating system, and which are packaged with your app\"s APK\n# https://developer.android.com/topic/libraries/support-library/androidx-rn\nandroid.useAndroidX=true\n# Enables namespacing of each library's R class so that its R class includes only the\n# resources declared in the library itself and none from the library's dependencies,\n# thereby reducing the size of the R class for that library\nandroid.nonTransitiveRClass=true
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>ISO-8859-1
===================================================================
diff --git a/gradle.properties b/gradle.properties
--- a/gradle.properties	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/gradle.properties	(date 1670083517038)
@@ -15,6 +15,7 @@
 # Android operating system, and which are packaged with your app"s APK
 # https://developer.android.com/topic/libraries/support-library/androidx-rn
 android.useAndroidX=true
+android.enableJetifier=true
 # Enables namespacing of each library's R class so that its R class includes only the
 # resources declared in the library itself and none from the library's dependencies,
 # thereby reducing the size of the R class for that library
Index: app/src/main/java/com/shasthosheba/patient/app/PreferenceManager.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/app/PreferenceManager.java b/app/src/main/java/com/shasthosheba/patient/app/PreferenceManager.java
new file mode 100644
--- /dev/null	(date 1670527661578)
+++ b/app/src/main/java/com/shasthosheba/patient/app/PreferenceManager.java	(date 1670527661578)
@@ -0,0 +1,61 @@
+package com.shasthosheba.patient.app;
+
+import android.content.Context;
+import android.content.SharedPreferences;
+
+import com.google.gson.Gson;
+import com.shasthosheba.patient.model.Intermediary;
+import com.shasthosheba.patient.model.User;
+
+public class PreferenceManager {
+    private static final String PREFERENCE_STORAGE = "shasthosheba_pref_storage";
+
+    public static enum PreferenceKey {
+        USER("user"),
+        INTERMEDIARY("intermediary"),
+        CONNECTED("is_connected");
+
+        private final String key;
+
+        PreferenceKey(String key) {
+            this.key = key;
+        }
+
+        public String getKey() {
+            return key;
+        }
+    }
+
+    private Context context;
+    private SharedPreferences preferences;
+    private Gson mGson = new Gson();
+
+    public PreferenceManager(Context context) {
+        this.context = context;
+        preferences = context.getSharedPreferences(PREFERENCE_STORAGE, Context.MODE_PRIVATE);
+    }
+
+    public void setUser(User user) {
+        preferences.edit().putString(PreferenceKey.USER.key, mGson.toJson(user)).apply();
+    }
+
+    public User getUser() {
+        return mGson.fromJson(preferences.getString(PreferenceKey.USER.key, ""), User.class);
+    }
+
+    public void setIntermediary(Intermediary intermediary) {
+        preferences.edit().putString(PreferenceKey.INTERMEDIARY.key, mGson.toJson(intermediary)).apply();
+    }
+
+    public Intermediary getIntermediary() {
+        return mGson.fromJson(preferences.getString(PreferenceKey.INTERMEDIARY.key, ""), Intermediary.class);
+    }
+
+    public void setConnected(boolean connected) {
+        preferences.edit().putBoolean(PreferenceKey.CONNECTED.key, connected).apply();
+    }
+
+    public boolean isConnected() {
+        return preferences.getBoolean(PreferenceKey.CONNECTED.key, false);
+    }
+}
Index: app/src/main/res/layout/activity_main.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_main.xml b/app/src/main/res/layout/activity_main.xml
new file mode 100644
--- /dev/null	(date 1670429927975)
+++ b/app/src/main/res/layout/activity_main.xml	(date 1670429927975)
@@ -0,0 +1,54 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".MainActivity">
+
+    <ImageView
+        android:id="@+id/iv_bg"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:scaleType="centerCrop"
+        android:src="@drawable/patient_background_low_opacity" />
+
+    <TextView
+        android:id="@+id/tv_patients_list_title"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_alignParentStart="true"
+        android:layout_alignParentTop="true"
+        android:layout_margin="16dp"
+        android:text="@string/patients"
+        android:textColor="@android:color/primary_text_light"
+        android:textSize="24sp" />
+
+    <ImageButton
+        android:id="@+id/ib_sign_out"
+        android:layout_width="24dp"
+        android:layout_height="24sp"
+        android:src="@drawable/ic_logout"
+        android:background="@null"
+        android:layout_margin="16dp"
+        android:scaleType="fitCenter"
+        android:layout_alignParentEnd="true"/>
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/rcv_patient_list"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_below="@id/tv_patients_list_title"
+        android:layout_marginHorizontal="16dp"
+        tools:listitem="@layout/rcv_patient_item" />
+
+    <com.google.android.material.floatingactionbutton.FloatingActionButton
+        android:id="@+id/fab_add_patient"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_alignParentEnd="true"
+        android:layout_alignParentBottom="true"
+        android:layout_margin="32dp"
+        android:contentDescription="@string/add_new_patient"
+        android:src="@android:drawable/ic_input_add" />
+</RelativeLayout>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/model/Patient.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/model/Patient.java b/app/src/main/java/com/shasthosheba/patient/model/Patient.java
new file mode 100644
--- /dev/null	(date 1670507560552)
+++ b/app/src/main/java/com/shasthosheba/patient/model/Patient.java	(date 1670507560552)
@@ -0,0 +1,66 @@
+package com.shasthosheba.patient.model;
+
+import java.util.List;
+import java.util.Objects;
+
+public class Patient extends BaseModel{
+    private String name;
+    private int birthYear;
+    private List<String> prescriptionIds;
+    private String id;
+
+    public Patient(String name, int birthYear, List<String> prescriptionIds, String id) {
+        this.name = name;
+        this.birthYear = birthYear;
+        this.prescriptionIds = prescriptionIds;
+        this.id = id;
+    }
+
+    public Patient() {
+    }
+
+    public String getName() {
+        return name;
+    }
+
+    public void setName(String name) {
+        this.name = name;
+    }
+
+    public int getBirthYear() {
+        return birthYear;
+    }
+
+    public void setBirthYear(int birthYear) {
+        this.birthYear = birthYear;
+    }
+
+    public List<String> getPrescriptionIds() {
+        return prescriptionIds;
+    }
+
+    public void setPrescriptionIds(List<String> prescriptionIds) {
+        this.prescriptionIds = prescriptionIds;
+    }
+
+    public String getId() {
+        return id;
+    }
+
+    public void setId(String id) {
+        this.id = id;
+    }
+
+    @Override
+    public boolean equals(Object o) {
+        if (this == o) return true;
+        if (o == null || getClass() != o.getClass()) return false;
+        Patient patient = (Patient) o;
+        return id.equals(patient.id);
+    }
+
+    @Override
+    public int hashCode() {
+        return Objects.hash(name, birthYear, prescriptionIds, id);
+    }
+}
Index: app/src/main/java/com/shasthosheba/patient/MainActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/MainActivity.java b/app/src/main/java/com/shasthosheba/patient/MainActivity.java
new file mode 100644
--- /dev/null	(date 1670551494611)
+++ b/app/src/main/java/com/shasthosheba/patient/MainActivity.java	(date 1670551494611)
@@ -0,0 +1,190 @@
+package com.shasthosheba.patient;
+
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AppCompatActivity;
+import androidx.core.app.NotificationCompat;
+import androidx.core.app.NotificationManagerCompat;
+import androidx.recyclerview.widget.LinearLayoutManager;
+
+import android.annotation.SuppressLint;
+import android.app.PendingIntent;
+import android.content.Intent;
+import android.os.Bundle;
+import android.view.Menu;
+import android.view.MenuItem;
+
+import com.google.firebase.auth.FirebaseAuth;
+import com.google.firebase.database.DataSnapshot;
+import com.google.firebase.database.DatabaseError;
+import com.google.firebase.database.DatabaseReference;
+import com.google.firebase.database.FirebaseDatabase;
+import com.google.firebase.database.ValueEventListener;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.shasthosheba.patient.app.IntentTags;
+import com.shasthosheba.patient.app.PreferenceManager;
+import com.shasthosheba.patient.app.PublicVariables;
+import com.shasthosheba.patient.databinding.ActivityMainBinding;
+import com.shasthosheba.patient.model.Call;
+import com.shasthosheba.patient.model.Intermediary;
+import com.shasthosheba.patient.model.Patient;
+import com.shasthosheba.patient.model.User;
+import com.shasthosheba.patient.patient.AddPatientActivity;
+import com.shasthosheba.patient.patient.PatientAdapter;
+import com.shasthosheba.patient.util.Utils;
+
+import java.util.ArrayList;
+
+import timber.log.Timber;
+
+public class MainActivity extends AppCompatActivity {
+
+    private FirebaseDatabase rtDB = FirebaseDatabase.getInstance(PublicVariables.FIREBASE_DB);
+    private DatabaseReference callRef = rtDB.getReference("call");
+    private DatabaseReference dataRef = rtDB.getReference(PublicVariables.INTERMEDIARY_KEY);
+
+    private ActivityMainBinding binding;
+    private User mUser;
+    private PreferenceManager preferenceManager;
+    private PatientAdapter adapter;
+
+    private FirebaseFirestore fireStoreDB = FirebaseFirestore.getInstance();
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        binding = ActivityMainBinding.inflate(getLayoutInflater());
+        setContentView(binding.getRoot());
+        preferenceManager = new PreferenceManager(this);
+        mUser = preferenceManager.getUser();
+
+        Utils.setStatusOnline(this);
+
+        adapter = new PatientAdapter(new ArrayList<>());
+        binding.rcvPatientList.setLayoutManager(new LinearLayoutManager(this));
+        binding.rcvPatientList.setAdapter(adapter);
+
+        binding.fabAddPatient.setOnClickListener(v -> startActivity(new Intent(MainActivity.this, AddPatientActivity.class)));
+
+        callRef.addValueEventListener(new ValueEventListener() {
+            @Override
+            public void onDataChange(@NonNull DataSnapshot snapshot) {
+                Timber.d("Call dataset changed callback");
+                Call call;
+                for (DataSnapshot snap : snapshot.getChildren()) {
+                    try {
+                        call = snap.getValue(Call.class);
+                        if (call != null && call.getWants().equals(mUser.getuId())) {
+                            Timber.i("Match found..Launching jitsi");
+                            notifyCall(call);
+                            break;
+                        }
+                    } catch (Exception e) {
+                        Timber.e(e);
+                    }
+                }
+            }
+
+            @Override
+            public void onCancelled(@NonNull DatabaseError error) {
+                Timber.e(error.toException());
+            }
+        });
+
+        fetchPatients(mUser.getuId());
+
+        binding.ibSignOut.setOnClickListener(v -> signOut(mUser));
+    }
+
+    @SuppressLint("NotifyDataSetChanged")
+    private void fetchPatients(String intermediaryId) {
+        Timber.v("inside fetch patients");
+        fireStoreDB.collection(PublicVariables.INTERMEDIARY_KEY).document(intermediaryId)
+                .addSnapshotListener((value, error) -> {
+                    if (error != null) {
+                        Timber.e(error);
+                        return;
+                    }
+                    if (value != null && value.exists()) {
+                        Intermediary intermediary = value.toObject(Intermediary.class);
+                        preferenceManager.setIntermediary(intermediary);
+                        //fetch all patients
+                        Timber.d("onSnapshot method:got value:%s", intermediary);
+                        assert intermediary != null;
+                        if (intermediary.getPatients() != null && !intermediary.getPatients().isEmpty()) {
+                            Timber.i("patient list is not empty:%s, contents:%s", intermediary.getPatients().size(), intermediary.getPatients());
+                            adapter.getList().clear();
+                            Timber.i("adapter cleared:%s", adapter.getItemCount());
+                            for (String id : intermediary.getPatients()) {
+                                Timber.d("fetching for patient id:%s", id);
+                                fireStoreDB.collection(PublicVariables.PATIENTS_KEY).document(id).get()
+                                        .addOnSuccessListener(documentSnapshot1 -> {
+                                            Patient fetchedPatient = documentSnapshot1.toObject(Patient.class);
+                                            Timber.d("fetched fetchedPatient:%s", fetchedPatient);
+                                            if (!adapter.getList().contains(fetchedPatient)) {
+                                                adapter.getList().add(fetchedPatient);
+                                                adapter.notifyItemInserted(adapter.getItemCount() - 1);
+                                            }
+                                        }).addOnFailureListener(Timber::e);
+                            }
+                            adapter.notifyDataSetChanged();
+                        }
+                    }
+                });
+    }
+
+    @Override
+    protected void onResume() {
+        super.onResume();
+        fetchPatients(mUser.getuId());
+        Utils.setStatusOnline(this);
+    }
+
+    private void notifyCall(Call call) {
+        Intent acceptIntent = new Intent(MainActivity.this, BroadcastReceiver.class)
+                .setAction(IntentTags.ACTION_ACCEPT.tag)
+                .putExtra(IntentTags.CALL_OBJ.tag, call);
+        PendingIntent acceptPendingIntent = PendingIntent.getBroadcast(MainActivity.this, 0, acceptIntent, PendingIntent.FLAG_IMMUTABLE);
+        Intent rejectIntent = new Intent(MainActivity.this, BroadcastReceiver.class)
+                .setAction(IntentTags.ACTION_REJECT.tag)
+                .putExtra(IntentTags.CALL_OBJ.tag, call);
+        PendingIntent rejectPendingIntent = PendingIntent.getBroadcast(MainActivity.this, 0, rejectIntent, PendingIntent.FLAG_IMMUTABLE);
+
+
+        NotificationCompat.Builder notificationBuilder = new NotificationCompat.Builder(MainActivity.this, PublicVariables.CHANNEL_ID)
+                .setSmallIcon(R.drawable.ic_notification)
+                .setContentTitle(call.isVideo() ? "Video call" : "Audio call")
+                .setContentText("Call from " + call.getDoctor())
+                .setPriority(NotificationCompat.PRIORITY_MAX)
+                .addAction(android.R.drawable.sym_action_call, "Accept", acceptPendingIntent)
+                .addAction(R.drawable.ic_round_call_end_24, "Reject", rejectPendingIntent)
+                .setOngoing(true);
+        NotificationManagerCompat.from(this).notify(PublicVariables.CALL_NOTIFICATION_ID, notificationBuilder.build());
+    }
+
+    @Override
+    public boolean onCreateOptionsMenu(Menu menu) {
+        getMenuInflater().inflate(R.menu.main_activity_menu, menu);
+        return true;
+    }
+
+    @Override
+    public boolean onOptionsItemSelected(@NonNull MenuItem item) {
+        if (item.getItemId() == R.id.menu_sign_out) {
+            signOut(mUser);
+            return true;
+        }
+        return super.onOptionsItemSelected(item);
+    }
+
+    private void signOut(User user) {
+        if (user == null) preferenceManager.getUser();
+        assert user != null;
+        user.setStatus("offline");
+        dataRef.child(user.getuId()).setValue(user)
+                .addOnCompleteListener(task -> {
+                    FirebaseAuth.getInstance().signOut();
+                    startActivity(new Intent(MainActivity.this, StartActivity.class));
+                });
+
+    }
+}
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/app/App.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/app/App.java b/app/src/main/java/com/shasthosheba/patient/app/App.java
new file mode 100644
--- /dev/null	(date 1670269571671)
+++ b/app/src/main/java/com/shasthosheba/patient/app/App.java	(date 1670269571671)
@@ -0,0 +1,19 @@
+package com.shasthosheba.patient.app;
+
+import android.app.Application;
+
+import com.shasthosheba.patient.BuildConfig;
+import com.shasthosheba.patient.R;
+import com.shasthosheba.patient.TagTree;
+
+import timber.log.Timber;
+
+public class App extends Application {
+    @Override
+    public void onCreate() {
+        super.onCreate();
+        if (BuildConfig.DEBUG) {
+            Timber.plant(new TagTree(getString(R.string.app_name), true));
+        }
+    }
+}
Index: app/src/test/java/com/example/doctor/ExampleUnitTest.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/test/java/com/example/doctor/ExampleUnitTest.java b/app/src/test/java/com/shasthosheba/patient/ExampleUnitTest.java
rename from app/src/test/java/com/example/doctor/ExampleUnitTest.java
rename to app/src/test/java/com/shasthosheba/patient/ExampleUnitTest.java
--- a/app/src/test/java/com/example/doctor/ExampleUnitTest.java	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/src/test/java/com/shasthosheba/patient/ExampleUnitTest.java	(date 1670269551095)
@@ -1,4 +1,4 @@
-package com.example.doctor;
+package com.shasthosheba.patient;
 
 import org.junit.Test;
 
Index: app/src/main/res/layout/activity_patient_details.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_patient_details.xml b/app/src/main/res/layout/activity_patient_details.xml
new file mode 100644
--- /dev/null	(date 1670579357027)
+++ b/app/src/main/res/layout/activity_patient_details.xml	(date 1670579357027)
@@ -0,0 +1,39 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    android:background="@drawable/patient_background_low_opacity"
+    tools:context=".patient.PatientDetailsActivity">
+
+    <TextView
+        android:id="@+id/tv_patient_name"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_margin="16dp"
+        android:textColor="@android:color/primary_text_light"
+        android:textSize="32sp"
+        tools:text="John" />
+
+    <TextView
+        android:id="@+id/tv_patient_age"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_below="@id/tv_patient_name"
+        android:layout_marginHorizontal="16dp"
+        android:layout_marginBottom="16dp"
+        android:textColor="@android:color/primary_text_light"
+        android:textSize="20sp"
+        tools:text="20 years" />
+
+    <androidx.recyclerview.widget.RecyclerView
+        android:id="@+id/rcv_prescription"
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_alignParentBottom="true"
+        android:layout_below="@id/tv_patient_age"
+        android:layout_marginHorizontal="16dp"
+        tools:listitem="@layout/rcv_pres_title_item" />
+
+</RelativeLayout>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/util/Utils.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/util/Utils.java b/app/src/main/java/com/shasthosheba/patient/util/Utils.java
new file mode 100644
--- /dev/null	(date 1670527661591)
+++ b/app/src/main/java/com/shasthosheba/patient/util/Utils.java	(date 1670527661591)
@@ -0,0 +1,47 @@
+package com.shasthosheba.patient.util;
+
+import android.content.Context;
+
+import androidx.annotation.NonNull;
+
+import com.google.android.gms.tasks.OnSuccessListener;
+import com.google.firebase.database.DataSnapshot;
+import com.google.firebase.database.DatabaseError;
+import com.google.firebase.database.DatabaseReference;
+import com.google.firebase.database.FirebaseDatabase;
+import com.google.firebase.database.ValueEventListener;
+import com.shasthosheba.patient.app.PreferenceManager;
+import com.shasthosheba.patient.app.PublicVariables;
+import com.shasthosheba.patient.model.User;
+
+import timber.log.Timber;
+
+public class Utils {
+    public static void setStatusOnline(Context context) {
+        User user = new PreferenceManager(context).getUser();
+        user.setStatus("online");
+        DatabaseReference dataRef = FirebaseDatabase.getInstance(PublicVariables.FIREBASE_DB).getReference(PublicVariables.INTERMEDIARY_KEY);
+        DatabaseReference conRef = FirebaseDatabase.getInstance(PublicVariables.FIREBASE_DB).getReference(".info/connected");
+        dataRef.child(user.getuId()).setValue(user)
+                .addOnSuccessListener(unused ->
+                        Timber.i("util:updated status online"))
+                .addOnFailureListener(Timber::e);
+
+        conRef.addValueEventListener(new ValueEventListener() {
+            @Override
+            public void onDataChange(@NonNull DataSnapshot snapshot) {
+                Timber.d(".info/connected:%s", snapshot.getValue());
+                if (Boolean.FALSE.equals(snapshot.getValue(Boolean.class))) { //NOT CONNECTED
+                    user.setStatus("offline");
+                    dataRef.child(user.getuId()).onDisconnect().setValue(user);
+                }
+                new PreferenceManager(context).setConnected(Boolean.TRUE.equals(snapshot.getValue(Boolean.class)));
+            }
+
+            @Override
+            public void onCancelled(@NonNull DatabaseError error) {
+                Timber.e(error.toException());
+            }
+        });
+    }
+}
Index: app/src/main/java/com/shasthosheba/patient/model/Intermediary.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/model/Intermediary.java b/app/src/main/java/com/shasthosheba/patient/model/Intermediary.java
new file mode 100644
--- /dev/null	(date 1670499486785)
+++ b/app/src/main/java/com/shasthosheba/patient/model/Intermediary.java	(date 1670499486785)
@@ -0,0 +1,42 @@
+package com.shasthosheba.patient.model;
+
+import java.util.List;
+
+public class Intermediary extends BaseModel{
+    private String name;
+    private String id;
+    private List<String> patients;
+
+    public Intermediary(String name, String id, List<String> patients) {
+        this.name = name;
+        this.id = id;
+        this.patients = patients;
+    }
+
+    public Intermediary() {
+    }
+
+    public String getName() {
+        return name;
+    }
+
+    public void setName(String name) {
+        this.name = name;
+    }
+
+    public String getId() {
+        return id;
+    }
+
+    public void setId(String id) {
+        this.id = id;
+    }
+
+    public List<String> getPatients() {
+        return patients;
+    }
+
+    public void setPatients(List<String> patients) {
+        this.patients = patients;
+    }
+}
Index: app/src/main/res/layout/activity_start.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.BaseRevisionTextPatchEP
<+><?xml version=\"1.0\" encoding=\"utf-8\"?>\n<androidx.constraintlayout.widget.ConstraintLayout xmlns:android=\"http://schemas.android.com/apk/res/android\"\n    xmlns:app=\"http://schemas.android.com/apk/res-auto\"\n    xmlns:tools=\"http://schemas.android.com/tools\"\n    android:layout_width=\"match_parent\"\n    android:layout_height=\"match_parent\"\n    tools:context=\".StartActivity\">\n\n</androidx.constraintlayout.widget.ConstraintLayout>
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_start.xml b/app/src/main/res/layout/activity_start.xml
--- a/app/src/main/res/layout/activity_start.xml	(revision bc8db748dc8fbeeb0b2f4f5ae358e89fac161d25)
+++ b/app/src/main/res/layout/activity_start.xml	(date 1670552203709)
@@ -1,9 +1,32 @@
 <?xml version="1.0" encoding="utf-8"?>
-<androidx.constraintlayout.widget.ConstraintLayout xmlns:android="http://schemas.android.com/apk/res/android"
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
     xmlns:app="http://schemas.android.com/apk/res-auto"
     xmlns:tools="http://schemas.android.com/tools"
     android:layout_width="match_parent"
     android:layout_height="match_parent"
+    android:background="@drawable/patient_background_low_opacity"
     tools:context=".StartActivity">
 
-</androidx.constraintlayout.widget.ConstraintLayout>
\ No newline at end of file
+    <TextView
+        android:id="@+id/tv_app_name"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:text="@string/app_name" />
+
+    <TextView
+        android:id="@+id/tv_connecting"
+        android:layout_width="wrap_content"
+        android:layout_height="wrap_content"
+        android:layout_above="@id/progress_bar"
+        android:layout_centerHorizontal="true"
+        android:textColor="@android:color/primary_text_light"
+        android:textSize="28sp"
+        android:text="@string/connecting" />
+
+    <ProgressBar
+        android:id="@+id/progress_bar"
+        android:layout_width="40dp"
+        android:layout_height="40dp"
+        android:layout_centerInParent="true" />
+
+</RelativeLayout>
\ No newline at end of file
Index: app/src/main/res/layout/activity_add_patient.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/layout/activity_add_patient.xml b/app/src/main/res/layout/activity_add_patient.xml
new file mode 100644
--- /dev/null	(date 1670503154734)
+++ b/app/src/main/res/layout/activity_add_patient.xml	(date 1670503154734)
@@ -0,0 +1,66 @@
+<?xml version="1.0" encoding="utf-8"?>
+<RelativeLayout xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto"
+    xmlns:tools="http://schemas.android.com/tools"
+    android:layout_width="match_parent"
+    android:layout_height="match_parent"
+    tools:context=".patient.AddPatientActivity">
+
+    <ImageView
+        android:id="@+id/iv_bg"
+        android:layout_width="match_parent"
+        android:layout_height="match_parent"
+        android:scaleType="centerCrop"
+        android:src="@drawable/patient_background_low_opacity" />
+
+    <androidx.appcompat.widget.LinearLayoutCompat
+        android:layout_width="match_parent"
+        android:layout_height="wrap_content"
+        android:layout_centerInParent="true"
+        android:orientation="vertical"
+        android:padding="16dp">
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/til_patient_name"
+            style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:hint="@string/patient_name"
+            android:textColorHint="@android:color/tertiary_text_light">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/tiet_patient_name"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:textColor="@android:color/primary_text_light"
+                android:inputType="text" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <com.google.android.material.textfield.TextInputLayout
+            android:id="@+id/til_patient_birth_year"
+            style="@style/Widget.MaterialComponents.TextInputLayout.OutlinedBox"
+            android:layout_width="match_parent"
+            android:layout_height="wrap_content"
+            android:hint="@string/patient_birth_year"
+            android:textColorHint="@android:color/tertiary_text_light">
+
+            <com.google.android.material.textfield.TextInputEditText
+                android:id="@+id/tiet_patient_birth_year"
+                android:layout_width="match_parent"
+                android:layout_height="wrap_content"
+                android:textColor="@android:color/primary_text_light"
+                android:inputType="number" />
+        </com.google.android.material.textfield.TextInputLayout>
+
+        <Button
+            android:id="@+id/btn_add_patient"
+            android:layout_width="wrap_content"
+            android:layout_height="wrap_content"
+            android:layout_gravity="end"
+            android:layout_margin="16dp"
+            android:text="@string/add" />
+
+    </androidx.appcompat.widget.LinearLayoutCompat>
+
+
+</RelativeLayout>
\ No newline at end of file
Index: app/src/main/java/com/shasthosheba/patient/patient/AddPatientActivity.java
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/java/com/shasthosheba/patient/patient/AddPatientActivity.java b/app/src/main/java/com/shasthosheba/patient/patient/AddPatientActivity.java
new file mode 100644
--- /dev/null	(date 1670510033561)
+++ b/app/src/main/java/com/shasthosheba/patient/patient/AddPatientActivity.java	(date 1670510033561)
@@ -0,0 +1,88 @@
+package com.shasthosheba.patient.patient;
+
+import android.os.Bundle;
+
+import androidx.annotation.NonNull;
+import androidx.appcompat.app.AppCompatActivity;
+
+import com.google.android.gms.tasks.OnFailureListener;
+import com.google.android.gms.tasks.OnSuccessListener;
+import com.google.firebase.firestore.FirebaseFirestore;
+import com.shasthosheba.patient.app.PreferenceManager;
+import com.shasthosheba.patient.app.PublicVariables;
+import com.shasthosheba.patient.databinding.ActivityAddPatientBinding;
+import com.shasthosheba.patient.model.Intermediary;
+import com.shasthosheba.patient.model.Patient;
+import com.shasthosheba.patient.util.Utils;
+
+import java.util.ArrayList;
+import java.util.Objects;
+
+import timber.log.Timber;
+
+public class AddPatientActivity extends AppCompatActivity {
+    private FirebaseFirestore fireStoreDB = FirebaseFirestore.getInstance();
+    private ActivityAddPatientBinding binding;
+    private PreferenceManager preferenceManager;
+
+    @Override
+    protected void onCreate(Bundle savedInstanceState) {
+        super.onCreate(savedInstanceState);
+        binding = ActivityAddPatientBinding.inflate(getLayoutInflater());
+        setContentView(binding.getRoot());
+        preferenceManager = new PreferenceManager(this);
+        Utils.setStatusOnline(this);
+        binding.btnAddPatient.setOnClickListener(v -> {
+            Patient patient = new Patient();
+            if (Objects.requireNonNull(binding.tietPatientName.getText()).toString().trim().isEmpty()) {
+                binding.tilPatientName.setError("Please enter name");
+                return;
+            } else {
+                binding.tilPatientName.setErrorEnabled(false);
+                patient.setName(binding.tietPatientName.getText().toString().trim());
+            }
+            if (Objects.requireNonNull(binding.tietPatientBirthYear.getText()).toString().trim().isEmpty()) {
+                binding.tilPatientBirthYear.setError("Please enter age");
+                return;
+            } else {
+                binding.tilPatientBirthYear.setErrorEnabled(false);
+                patient.setBirthYear(Integer.parseInt(binding.tietPatientBirthYear.getText().toString().trim()));
+            }
+            binding.tilPatientName.setEnabled(false);
+            binding.tilPatientBirthYear.setEnabled(false);
+            fireStoreDB.collection(PublicVariables.PATIENTS_KEY).add(patient).addOnSuccessListener(documentReference -> {
+                String patientId = documentReference.getId();
+                Timber.d("new patientId:%s", patientId);
+                Timber.d("new patient doc path:%s", documentReference.getPath());
+                Intermediary intermediary = preferenceManager.getIntermediary();
+                intermediary.getPatients().add(patientId);
+                patient.setId(patientId);
+                documentReference.set(patient)
+                        .addOnSuccessListener(unused -> fireStoreDB.collection(PublicVariables.INTERMEDIARY_KEY).document(intermediary.getId()).set(intermediary)
+                                .addOnSuccessListener(unused1 -> finish())
+                                .addOnFailureListener(e -> {
+                                    binding.tilPatientName.setEnabled(true);
+                                    binding.tilPatientBirthYear.setEnabled(true);
+                                    Timber.e(e);
+                                }))
+                        .addOnFailureListener(e -> {
+                            binding.tilPatientName.setEnabled(true);
+                            binding.tilPatientBirthYear.setEnabled(true);
+                            Timber.e(e);
+                        });
+
+            }).addOnFailureListener(e -> {
+                binding.tilPatientName.setEnabled(true);
+                binding.tilPatientBirthYear.setEnabled(true);
+                Timber.e(e);
+            });
+        });
+
+    }
+
+    @Override
+    protected void onResume() {
+        super.onResume();
+        Utils.setStatusOnline(this);
+    }
+}
\ No newline at end of file
Index: app/src/main/res/menu/main_activity_menu.xml
IDEA additional info:
Subsystem: com.intellij.openapi.diff.impl.patch.CharsetEP
<+>UTF-8
===================================================================
diff --git a/app/src/main/res/menu/main_activity_menu.xml b/app/src/main/res/menu/main_activity_menu.xml
new file mode 100644
--- /dev/null	(date 1670349041349)
+++ b/app/src/main/res/menu/main_activity_menu.xml	(date 1670349041349)
@@ -0,0 +1,11 @@
+<?xml version="1.0" encoding="utf-8"?>
+<menu xmlns:android="http://schemas.android.com/apk/res/android"
+    xmlns:app="http://schemas.android.com/apk/res-auto">
+    <item
+        android:id="@+id/menu_sign_out"
+        android:actionLayout="@layout/activity_main"
+        android:icon="@drawable/ic_logout"
+        app:showAsAction="always"
+        android:title="@string/sign_out"/>
+
+</menu>
\ No newline at end of file
